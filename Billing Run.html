<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Title -->
    <title>Excis Billing System</title>
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="author" content="DexignLab">
    <meta name="robots" content="">
    
    <meta property="og:image" content="">
    <meta name="format-detection" content="telephone=no">

    <!-- Mobile Specific -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon icon -->

    <link rel="icon" type="image/png" sizes="16x16" href="./public/assets/images/favicon_io/favicon.ico">

    <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet">

    <link href="./public/assets/vendor/bootstrap-select/dist/css/bootstrap-select.min.css" rel="stylesheet" type="text/css" />

    <link href="./public/assets/css/style.css" rel="stylesheet" type="text/css" />

</head>

<body>

    <!--*******************
        Preloader start
    ********************-->
    <div id="preloader">
        <div class="loader">
            <div class="dots">
                <div class="dot mainDot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>

        </div>
    </div>
    <!--*******************
        Preloader end
    ********************-->

    <!--**********************************
        Main wrapper start
    ***********************************-->
    <div id="main-wrapper">

 <!-- Nav header start -->
 <div class="nav-header">
    <style>
        .brand-logo {
            display: flex;
            align-items: center;
        }

        .logo-abbr {
            margin-right: 10px; /* Adjust spacing as needed */
        }

        .logo-text {
            font-size: 24px; /* Adjust as needed */
            font-weight: bold; /* Adjust as needed */
            color: #ffffff; /* Adjust as needed */
        }

        /* Media query for mobile devices */
        @media (max-width: 768px) {
            .logo-text {
                display: none; /* Hide text on mobile */
            }
        }

        /* Style when side menu is hidden */
        .side-menu-hidden .logo-text {
            display: none; /* Hide text */
        }

        .side-menu-hidden .nav-header {
            justify-content: center; /* Center the logo when side menu is hidden */
        }
    </style>

    <a href="#" class="brand-logo">
        <img src="./public/assets/images/logo transparent.png" alt="Brand Logo" class="logo-abbr" width="40" height="40">
        <style>
    .logo-text {
        color: rgb(255, 255, 255) !important;
    }
</style>

<span class="logo-text">FSO</span>

    </a>

    <div class="brand-title">
        <!-- Add content here if needed -->
    </div>

    <div class="nav-control">
        <div class="hamburger" id="hamburger-menu">
            <span class="line"></span><span class="line"></span><span class="line"></span>
            <svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="22" y="11" width="4" height="4" rx="2" fill="#2A353A"/>
                <rect x="11" width="4" height="4" rx="2" fill="#2A353A"/>
                <rect x="22" width="4" height="4" rx="2" fill="#2A353A"/>
                <rect x="11" y="11" width="4" height="4" rx="2" fill="#2A353A"/>
                <rect x="11" y="22" width="4" height="4" rx="2" fill="#2A353A"/>
                <rect width="4" height="4" rx="2" fill="#2A353A"/>
                <rect y="11" width="4" height="4" rx="2" fill="#2A353A"/>
                <rect x="22" y="22" width="4" height="4" rx="2" fill="#2A353A"/>
                <rect y="22" width="4" height="4" rx="2" fill="#2A353A"/>
            </svg>
        </div>
    </div>
</div>
<!-- Nav header end -->

<script>
    document.getElementById('hamburger-menu').addEventListener('click', function() {
        const mainWrapper = document.getElementById('main-wrapper');
        mainWrapper.classList.toggle('side-menu-hidden');
    });
</script>
    
    <!-- Nav header end -->
        <!--**********************************
	Chat box start

        <div class="chatbox">
            <div class="chatbox-close"></div>
            <div class="custom-tab-1">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#notes">Notes</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#alerts">Alerts</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" data-bs-toggle="tab" href="#chat">Chat</a>
                    </li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane fade active show" id="chat" role="tabpanel">
                        <div class="card mb-sm-3 mb-md-0 contacts_card dlab-chat-user-box">
                            <div class="card-header chat-list-header text-center">
                                <a href="javascript:void(0);" data-bs-toggle="modal" data-bs-target="#chat_model"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewBox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect fill="#000000" x="4" y="11" width="16" height="2" rx="1"/><rect fill="#000000" opacity="0.3" transform="translate(12.000000, 12.000000) rotate(-270.000000) translate(-12.000000, -12.000000) " x="4" y="11" width="16" height="2" rx="1"/></g></svg></a>
                                <div>
                                    <h6 class="mb-1">Chat List</h6>
                                    <p class="mb-0">Show All</p>
                                </div>
                                <a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewBox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect x="0" y="0" width="24" height="24"/><circle fill="#000000" cx="5" cy="12" r="2"/><circle fill="#000000" cx="12" cy="12" r="2"/><circle fill="#000000" cx="19" cy="12" r="2"/></g></svg></a>
                            </div>
                            <div class="card-body contacts_body p-0 dlab-scroll  " id="DLAB_W_Contacts_Body">
                                <ul class="contacts">
                                    <li class="name-first-letter">A</li>
                                    <li class="active dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/1.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Archie Parker</span>
                                                <p>Kalid is online</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/2.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon offline"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Alfie Mason</span>
                                                <p>Taherah left 7 mins ago</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/3.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>AharlieKane</span>
                                                <p>Sami is online</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/4.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon offline"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Athan Jacoby</span>
                                                <p>Nargis left 30 mins ago</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="name-first-letter">B</li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/5.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon offline"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Bashid Samim</span>
                                                <p>Rashid left 50 mins ago</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/1.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Breddie Ronan</span>
                                                <p>Kalid is online</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/2.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon offline"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Ceorge Carson</span>
                                                <p>Taherah left 7 mins ago</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="name-first-letter">D</li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/3.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Darry Parker</span>
                                                <p>Sami is online</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/4.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon offline"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Denry Hunter</span>
                                                <p>Nargis left 30 mins ago</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="name-first-letter">J</li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/5.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon offline"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Jack Ronan</span>
                                                <p>Rashid left 50 mins ago</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/1.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Jacob Tucker</span>
                                                <p>Kalid is online</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/2.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon offline"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>James Logan</span>
                                                <p>Taherah left 7 mins ago</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/3.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Joshua Weston</span>
                                                <p>Sami is online</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="name-first-letter">O</li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/4.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon offline"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Oliver Acker</span>
                                                <p>Nargis left 30 mins ago</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="dlab-chat-user">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont">
                                                <img src="./public/assets/images/avatar/5.jpg" class="rounded-circle user_img" alt="">
                                                <span class="online_icon offline"></span>
                                            </div>
                                            <div class="user_info">
                                                <span>Oscar Weston</span>
                                                <p>Rashid left 50 mins ago</p>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="card chat dlab-chat-history-box d-none">
                            <div class="card-header chat-list-header text-center">
                                <a href="javascript:void(0);" class="dlab-chat-history-back">
							<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewBox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon points="0 0 24 0 24 24 0 24"/><rect fill="#000000" opacity="0.3" transform="translate(15.000000, 12.000000) scale(-1, 1) rotate(-90.000000) translate(-15.000000, -12.000000) " x="14" y="7" width="2" height="10" rx="1"/><path d="M3.7071045,15.7071045 C3.3165802,16.0976288 2.68341522,16.0976288 2.29289093,15.7071045 C1.90236664,15.3165802 1.90236664,14.6834152 2.29289093,14.2928909 L8.29289093,8.29289093 C8.67146987,7.914312 9.28105631,7.90106637 9.67572234,8.26284357 L15.6757223,13.7628436 C16.0828413,14.136036 16.1103443,14.7686034 15.7371519,15.1757223 C15.3639594,15.5828413 14.7313921,15.6103443 14.3242731,15.2371519 L9.03007346,10.3841355 L3.7071045,15.7071045 Z" fill="#000000" fill-rule="nonzero" transform="translate(9.000001, 11.999997) scale(-1, -1) rotate(90.000000) translate(-9.000001, -11.999997) "/></g></svg>
						</a>
                                <div>
                                    <h6 class="mb-1">Chat with Khelesh</h6>
                                    <p class="mb-0 text-success">Online</p>
                                </div>
                                <div class="dropdown">
                                    <a href="javascript:void(0);" data-bs-toggle="dropdown" aria-expanded="false">
								<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewBox="0 0 24 24" version="1.1" >
									<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
										<rect x="0" y="0" width="24" height="24"/>
										<circle fill="#000000" cx="5" cy="12" r="2"/>
										<circle fill="#000000" cx="12" cy="12" r="2"/>
										<circle fill="#000000" cx="19" cy="12" r="2"/>
									</g>
								</svg>
							</a>
                                    <ul class="dropdown-menu dropdown-menu-end">
                                        <li class="dropdown-item"><i class="fa fa-user-circle text-primary me-2"></i> View profile</li>
                                        <li class="dropdown-item"><i class="fa fa-users text-primary me-2"></i> Add to btn-close friends</li>
                                        <li class="dropdown-item"><i class="fa fa-plus text-primary me-2"></i> Add to group</li>
                                        <li class="dropdown-item"><i class="fa fa-ban text-primary me-2"></i> Block</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="card-body msg_card_body dlab-scroll" id="DLAB_W_Contacts_Body3">
                                <div class="d-flex justify-content-start mb-4">
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                    <div class="msg_cotainer">
                                        Hi, how are you samim?
                                        <span class="msg_time">8:40 AM, Today</span>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-end mb-4">
                                    <div class="msg_cotainer_send">
                                        Hi Khalid i am good tnx how about you?
                                        <span class="msg_time_send">8:55 AM, Today</span>
                                    </div>
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/2.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                </div>
                                <div class="d-flex justify-content-start mb-4">
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                    <div class="msg_cotainer">
                                        I am good too, thank you for your chat template
                                        <span class="msg_time">9:00 AM, Today</span>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-end mb-4">
                                    <div class="msg_cotainer_send">
                                        You are welcome
                                        <span class="msg_time_send">9:05 AM, Today</span>
                                    </div>
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/2.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                </div>
                                <div class="d-flex justify-content-start mb-4">
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                    <div class="msg_cotainer">
                                        I am looking for your next templates
                                        <span class="msg_time">9:07 AM, Today</span>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-end mb-4">
                                    <div class="msg_cotainer_send">
                                        Ok, thank you have a good day
                                        <span class="msg_time_send">9:10 AM, Today</span>
                                    </div>
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/2.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                </div>
                                <div class="d-flex justify-content-start mb-4">
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                    <div class="msg_cotainer">
                                        Bye, see you
                                        <span class="msg_time">9:12 AM, Today</span>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-start mb-4">
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                    <div class="msg_cotainer">
                                        Hi, how are you samim?
                                        <span class="msg_time">8:40 AM, Today</span>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-end mb-4">
                                    <div class="msg_cotainer_send">
                                        Hi Khalid i am good tnx how about you?
                                        <span class="msg_time_send">8:55 AM, Today</span>
                                    </div>
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/2.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                </div>
                                <div class="d-flex justify-content-start mb-4">
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                    <div class="msg_cotainer">
                                        I am good too, thank you for your chat template
                                        <span class="msg_time">9:00 AM, Today</span>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-end mb-4">
                                    <div class="msg_cotainer_send">
                                        You are welcome
                                        <span class="msg_time_send">9:05 AM, Today</span>
                                    </div>
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/2.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                </div>
                                <div class="d-flex justify-content-start mb-4">
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                    <div class="msg_cotainer">
                                        I am looking for your next templates
                                        <span class="msg_time">9:07 AM, Today</span>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-end mb-4">
                                    <div class="msg_cotainer_send">
                                        Ok, thank you have a good day
                                        <span class="msg_time_send">9:10 AM, Today</span>
                                    </div>
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/2.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                </div>
                                <div class="d-flex justify-content-start mb-4">
                                    <div class="img_cont_msg">
                                        <img src="./public/assets/images/avatar/1.jpg" class="rounded-circle user_img_msg" alt="">
                                    </div>
                                    <div class="msg_cotainer">
                                        Bye, see you
                                        <span class="msg_time">9:12 AM, Today</span>
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer type_msg">
                                <div class="input-group">
                                    <textarea class="form-control" placeholder="Type your message..."></textarea>
                                    <div class="input-group-append">
                                        <button type="button" class="btn btn-primary"><i class="fa fa-location-arrow"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="alerts" role="tabpanel">
                        <div class="card mb-sm-3 mb-md-0 contacts_card">
                            <div class="card-header chat-list-header text-center">
                                <a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewBox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect x="0" y="0" width="24" height="24"/><circle fill="#000000" cx="5" cy="12" r="2"/><circle fill="#000000" cx="12" cy="12" r="2"/><circle fill="#000000" cx="19" cy="12" r="2"/></g></svg></a>
                                <div>
                                    <h6 class="mb-1">Notications</h6>
                                    <p class="mb-0">Show All</p>
                                </div>
                                <a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewBox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect x="0" y="0" width="24" height="24"/><path d="M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/><path d="M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z" fill="#000000" fill-rule="nonzero"/></g></svg></a>
                            </div>
                            <div class="card-body contacts_body p-0 dlab-scroll" id="DLAB_W_Contacts_Body1">
                                <ul class="contacts">
                                    <li class="name-first-letter">SEVER STATUS</li>
                                    <li class="active">
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont primary">KK</div>
                                            <div class="user_info">
                                                <span>David Nester Birthday</span>
                                                <p class="text-primary">Today</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="name-first-letter">SOCIAL</li>
                                    <li>
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont success">RU</div>
                                            <div class="user_info">
                                                <span>Perfection Simplified</span>
                                                <p>Jame Smith commented on your status</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="name-first-letter">SEVER STATUS</li>
                                    <li>
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont primary">AU</div>
                                            <div class="user_info">
                                                <span>AharlieKane</span>
                                                <p>Sami is online</p>
                                            </div>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="d-flex bd-highlight">
                                            <div class="img_cont info">MO</div>
                                            <div class="user_info">
                                                <span>Athan Jacoby</span>
                                                <p>Nargis left 30 mins ago</p>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                            <div class="card-footer"></div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="notes">
                        <div class="card mb-sm-3 mb-md-0 note_card">
                            <div class="card-header chat-list-header text-center">
                                <a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewBox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect fill="#000000" x="4" y="11" width="16" height="2" rx="1"/><rect fill="#000000" opacity="0.3" transform="translate(12.000000, 12.000000) rotate(-270.000000) translate(-12.000000, -12.000000) " x="4" y="11" width="16" height="2" rx="1"/></g></svg></a>
                                <div>
                                    <h6 class="mb-1">Notes</h6>
                                    <p class="mb-0">Add New Nots</p>
                                </div>
                                <a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewBox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect x="0" y="0" width="24" height="24"/><path d="M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/><path d="M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z" fill="#000000" fill-rule="nonzero"/></g></svg></a>
                            </div>
                            <div class="card-body contacts_body p-0 dlab-scroll" id="DLAB_W_Contacts_Body2">
                                <ul class="contacts">
                                    <li class="active">
                                        <div class="d-flex bd-highlight">
                                            <div class="user_info">
                                                <span>New order placed..</span>
                                                <p>10 Aug 2020</p>
                                            </div>
                                            <div class="ms-auto">
                                                <a href="javascript:void(0);" class="btn btn-primary btn-xs sharp me-1"><i class="fas fa-pencil-alt"></i></a>
                                                <a href="javascript:void(0);" class="btn btn-danger btn-xs sharp"><i class="fa fa-trash"></i></a>
                                            </div>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="d-flex bd-highlight">
                                            <div class="user_info">
                                                <span>Youtube, a video-sharing website..</span>
                                                <p>10 Aug 2020</p>
                                            </div>
                                            <div class="ms-auto">
                                                <a href="javascript:void(0);" class="btn btn-primary btn-xs sharp me-1"><i class="fas fa-pencil-alt"></i></a>
                                                <a href="javascript:void(0);" class="btn btn-danger btn-xs sharp"><i class="fa fa-trash"></i></a>
                                            </div>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="d-flex bd-highlight">
                                            <div class="user_info">
                                                <span>john just buy your product..</span>
                                                <p>10 Aug 2020</p>
                                            </div>
                                            <div class="ms-auto">
                                                <a href="javascript:void(0);" class="btn btn-primary btn-xs sharp me-1"><i class="fas fa-pencil-alt"></i></a>
                                                <a href="javascript:void(0);" class="btn btn-danger btn-xs sharp"><i class="fa fa-trash"></i></a>
                                            </div>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="d-flex bd-highlight">
                                            <div class="user_info">
                                                <span>Athan Jacoby</span>
                                                <p>10 Aug 2020</p>
                                            </div>
                                            <div class="ms-auto">
                                                <a href="javascript:void(0);" class="btn btn-primary btn-xs sharp me-1"><i class="fas fa-pencil-alt"></i></a>
                                                <a href="javascript:void(0);" class="btn btn-danger btn-xs sharp"><i class="fa fa-trash"></i></a>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
       **********************************
	Chat box End
***********************************-->
        <!--**********************************
	Header start
***********************************-->
        <div class="header">
            <div class="header-content">
                <nav class="navbar navbar-expand">
                    <div class="collapse navbar-collapse justify-content-between">
                        <div class="header-left">
                            <div class="dashboard_bar">
                                Billing Run </div>
                        </div>
                        <ul class="navbar-nav header-right">
                            <li class="nav-item dropdown notification_dropdown all">
                                <a class="nav-link" href="javascript:void(0);" role="button" data-bs-toggle="dropdown">
						<svg height="24" class="svg-main-icon" viewBox="0 0 32 32" width="24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><clipPath id="clip_1"><path id="artboard_1" clip-rule="evenodd" d="m0 0h32v32h-32z"/></clipPath><g id="select" clip-path="url(#clip_1)"><path id="Vector" d="m4.70222 7.16834-.12871-.2574c-.0593-.11861-.13904-.22136-.23922-.30824-.10018-.08689-.21317-.1513-.33898-.19323-.1258-.04194-.25484-.0582-.38711-.0488-.13228.0094-.25772.04375-.37633.10306-.24699.12349-.41414.31622-.50147.5782-.08732.26197-.06923.51645.05426.76344l1.32093 2.64183c.0593.1186.13904.2214.23922.3083.10018.0868.21317.1512.33898.1932.1258.0419.25484.0582.38711.0488.13228-.0094.25772-.0438.37633-.1031.01854-.0092.03678-.0191.05471-.0295s.03552-.0214.05277-.0329l5.99999-3.99995c.1104-.07356.2024-.16543.2762-.27561s.1237-.23029.1497-.36032c.026-.13004.0261-.2601.0004-.39019-.0257-.13008-.0754-.25029-.1489-.36063-.1532-.22977-.3652-.37173-.636-.42588-.2707-.05416-.521-.00465-.7508.14853l-1.94316 1.29545-3.1143 2.07619zm11.29778-1.16834c-.2761 0-.5118.09763-.7071.29289s-.2929.43097-.2929.70711.0976.51184.2929.70711c.1953.19526.431.29289.7071.29289h14c.2761 0 .5118-.09763.7071-.29289.1953-.19527.2929-.43097.2929-.70711s-.0976-.51185-.2929-.70711-.431-.29289-.7071-.29289zm-11.27691 9.1683-.12871-.2574c-.12349-.2469-.31622-.4141-.5782-.5014-.26197-.0874-.51645-.0693-.76344.0542-.11861.0593-.22135.1391-.30824.2393-.08688.1001-.15129.2131-.19323.3389-.04193.1258-.0582.2549-.0488.3871.0094.1323.04376.2578.10306.3764l1.32092 2.6418c.1235.247.31623.4142.5782.5015.26198.0873.51646.0692.76345-.0543.01854-.0092.03678-.0191.05471-.0295s.03552-.0214.05277-.0329l6.00002-3.9999c.2298-.1532.3717-.3652.4259-.636.0541-.2708.0046-.521-.1486-.7508-.1531-.2298-.3651-.3717-.6359-.4259-.2708-.0541-.521-.0046-.7508.1485l-5.05749 3.3717zm11.27691-.1683c-.2761 0-.5118.0976-.7071.2929s-.2929.431-.2929.7071.0976.5118.2929.7071.431.2929.7071.2929h14c.2761 0 .5118-.0976.7071-.2929s.2929-.431.2929-.7071-.0976-.5118-.2929-.7071-.431-.2929-.7071-.2929zm-11.27691 8.1683-.12871-.2574c-.12349-.247-.31622-.4141-.5782-.5014-.26197-.0874-.51645-.0693-.76344.0542-.11861.0593-.22135.1391-.30824.2393-.08688.1001-.15129.2131-.19323.3389-.04193.1258-.0582.2549-.0488.3871.0094.1323.04376.2578.10306.3764l1.32092 2.6418c.1235.247.31623.4142.5782.5015.26198.0873.51646.0692.76345-.0543.01854-.0092.03678-.0191.05471-.0295s.03552-.0214.05277-.0329l6.00002-4c.1103-.0735.2024-.1654.2762-.2756.0738-.1101.1237-.2303.1497-.3603s.0261-.2601.0004-.3902c-.0258-.1301-.0754-.2503-.149-.3606-.1531-.2298-.3651-.3717-.6359-.4259-.2708-.0541-.521-.0046-.7508.1485l-1.94319 1.2955-3.1143 2.0762zm11.27691.8317c-.2761 0-.5118.0976-.7071.2929s-.2929.431-.2929.7071.0976.5118.2929.7071.431.2929.7071.2929h14c.2761 0 .5118-.0976.7071-.2929s.2929-.431.2929-.7071-.0976-.5118-.2929-.7071-.431-.2929-.7071-.2929z" fill-rule="evenodd"/></g></svg>
					</a>
                                <div class="dropdown-menu dropdown-menu-end p-0">
                                    <div class="card mb-0">
                                        <div class="card-header border-0 d-block h-auto">
                                            <ul class="d-flex align-items-center justify-content-around">
                                                <li class="nav-item dropdown notification_dropdown">
                                                    <a class="nav-link  menu-wallet" href="javascript:void(0);">
													<svg id="Layer_1" enable-background="new 0 0 512 512" height="18" viewBox="0 0 512 512" width="18" xmlns="http://www.w3.org/2000/svg"><g><path d="m174 240h-108c-36.393 0-66-29.607-66-66v-108c0-36.393 29.607-66 66-66h108c36.393 0 66 29.607 66 66v108c0 36.393-29.607 66-66 66zm-108-208c-18.748 0-34 15.252-34 34v108c0 18.748 15.252 34 34 34h108c18.748 0 34-15.252 34-34v-108c0-18.748-15.252-34-34-34z"/><path d="m446 240h-108c-36.393 0-66-29.607-66-66v-108c0-36.393 29.607-66 66-66h108c36.393 0 66 29.607 66 66v108c0 36.393-29.607 66-66 66zm-108-208c-18.748 0-34 15.252-34 34v108c0 18.748 15.252 34 34 34h108c18.748 0 34-15.252 34-34v-108c0-18.748-15.252-34-34-34z"/><path d="m392 512c-66.168 0-120-53.832-120-120s53.832-120 120-120 120 53.832 120 120-53.832 120-120 120zm0-208c-48.523 0-88 39.477-88 88s39.477 88 88 88 88-39.477 88-88-39.477-88-88-88z"/><path d="m174 512h-108c-36.393 0-66-29.607-66-66v-108c0-36.393 29.607-66 66-66h108c36.393 0 66 29.607 66 66v108c0 36.393-29.607 66-66 66zm-108-208c-18.748 0-34 15.252-34 34v108c0 18.748 15.252 34 34 34h108c18.748 0 34-15.252 34-34v-108c0-18.748-15.252-34-34-34z"/></g></svg>
											</a>
                                                </li>
                                                <li class="nav-item dropdown notification_dropdown">
                                                    <a class="nav-link bell dz-theme-mode" href="javascript:void(0);">
													<svg id="icon-light" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
											<svg id="icon-dark" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
											</a>
                                                </li>
                                                <li class="nav-item dropdown notification_dropdown">
                                                    <a class="nav-link bell dz-fullscreen" href="javascript:void(0);">
												<svg id="icon-full" viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" style="stroke-dasharray: 37, 57; stroke-dashoffset: 0;"></path></svg>
												<svg id="icon-minimize" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="A098AE" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-minimize"><path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3" style="stroke-dasharray: 37, 57; stroke-dashoffset: 0;"></path></svg>
											</a>
                                                </li>

                                            </ul>
                                        </div>
                                    </div>

                                </div>
                            </li>
                            <li class="nav-item dropdown notification_dropdown search-area-header">
                                <a class="nav-link" href="javascript:void(0);" role="button" data-bs-toggle="dropdown">
							<svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path d="M27.6 25.8L22 20.2C23.3 18.5 24.1 16.4 24.1 14.1C24.1 8.60001 19.6 4.10001 14.1 4.10001C8.6 4.10001 4 8.60001 4 14.1C4 19.6 8.5 24.1 14 24.1C16.3 24.1 18.5 23.3 20.2 21.9L25.8 27.5C26 27.7 26.4 27.9 26.7 27.9C27 27.9 27.3 27.8 27.6 27.5C28.1 27.1 28.1 26.3 27.6 25.8ZM6.5 14.1C6.5 10 9.9 6.60001 14 6.60001C18.1 6.60001 21.5 10 21.5 14.1C21.5 18.2 18.1 21.6 14 21.6C9.9 21.6 6.5 18.3 6.5 14.1Z" fill="#A098AE"/>
							</svg>
						
						</a>
                                <div class="dropdown-menu dropdown-menu-end p-0 rounded">
                                    <div class="card mb-0">
                                        <div class="card-body px-0">
                                            <div class="px-3">
                                                <div class="input-group search-area w-100">
                                                    <input type="text" class="form-control" placeholder="Search here...">
                                                    <span class="input-group-text"><a href="javascript:void(0)">
												<svg width="15" height="15" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
													<path d="M17.5605 15.4395L13.7527 11.6317C14.5395 10.446 15 9.02625 15 7.5C15 3.3645 11.6355 0 7.5 0C3.3645 0 0 3.3645 0 7.5C0 11.6355 3.3645 15 7.5 15C9.02625 15 10.446 14.5395 11.6317 13.7527L15.4395 17.5605C16.0245 18.1462 16.9755 18.1462 17.5605 17.5605C18.1462 16.9747 18.1462 16.0252 17.5605 15.4395V15.4395ZM2.25 7.5C2.25 4.605 4.605 2.25 7.5 2.25C10.395 2.25 12.75 4.605 12.75 7.5C12.75 10.395 10.395 12.75 7.5 12.75C4.605 12.75 2.25 10.395 2.25 7.5V7.5Z" fill="#01A3FF"></path>
												</svg>
											</a></span>
                                                </div>
                                                <h6 class="my-2 mt-3">Recently Searched:</h6>
                                            </div>
                                            <div class="dlab-scroll px-3 mt-3 height300">
                                                <ul class="d-flex align-items-center mb-3">
                                                    <li>
                                                        <img src="./public/assets/images/avatar/1.jpg" class="avatar avatar-sm" alt="">
                                                        <a href="javascript:void(0);" class="ms-2">Benjamin</a>

                                                    </li>
                                                    <li class="ms-auto"><i class="fa-solid fa-trash"></i></li>
                                                </ul>
                                                <ul class="d-flex align-items-center mb-3">
                                                    <li>
                                                        <img src="./public/assets/images/avatar/2.jpg" class="avatar avatar-sm" alt="">
                                                        <a href="javascript:void(0);" class="ms-2">Oliver</a>
                                                    </li>
                                                    <li class="ms-auto"><i class="fa-solid fa-trash"></i></li>
                                                </ul>
                                                <ul class="d-flex align-items-center mb-3">
                                                    <li>
                                                        <img src="./public/assets/images/avatar/1.jpg" class="avatar avatar-sm" alt="">
                                                        <a href="javascript:void(0);" class="ms-2">Lucas</a>

                                                    </li>
                                                    <li class="ms-auto"><i class="fa-solid fa-trash"></i></li>
                                                </ul>
                                                <ul class="d-flex align-items-center mb-3">
                                                    <li>
                                                        <img src="./public/assets/images/avatar/2.jpg" class="avatar avatar-sm" alt="">
                                                        <a href="javascript:void(0);" class="ms-2">Benjamin</a>

                                                    </li>
                                                    <li class="ms-auto"><i class="fa-solid fa-trash"></i></li>
                                                </ul>
                                                <ul class="d-flex align-items-center mb-3">
                                                    <li>
                                                        <img src="./public/assets/images/avatar/4.jpg" class="avatar avatar-sm" alt="">
                                                        <a href="javascript:void(0);" class="ms-2">Benjamin</a>

                                                    </li>
                                                    <li class="ms-auto"><i class="fa-solid fa-trash"></i></li>
                                                </ul>
                                                <ul class="d-flex align-items-center mb-3">
                                                    <li>
                                                        <img src="./public/assets/images/avatar/3.jpg" class="avatar avatar-sm" alt="">
                                                        <a href="javascript:void(0);" class="ms-2">Benjamin</a>

                                                    </li>
                                                    <li class="ms-auto"><i class="fa-solid fa-trash"></i></li>
                                                </ul>
                                                <ul class="d-flex align-items-center mb-3">
                                                    <li>
                                                        <img src="./public/assets/images/avatar/2.jpg" class="avatar avatar-sm" alt="">
                                                        <a href="javascript:void(0);" class="ms-2">Benjamin</a>

                                                    </li>
                                                    <li class="ms-auto"><i class="fa-solid fa-trash"></i></li>
                                                </ul>
                                                <ul class="d-flex align-items-center mb-3">
                                                    <li>
                                                        <img src="./public/assets/images/avatar/1.jpg" class="avatar avatar-sm" alt="">
                                                        <a href="javascript:void(0);" class="ms-2">Benjamin</a>

                                                    </li>
                                                    <li class="ms-auto"><i class="fa-solid fa-trash"></i></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li class="nav-item dropdown notification_dropdown">
                                <a class="nav-link  menu-wallet" href="javascript:void(0);">
							<svg id="Layer_2" enable-background="new 0 0 512 512" height="18" viewBox="0 0 512 512" width="18" xmlns="http://www.w3.org/2000/svg"><g><path d="m174 240h-108c-36.393 0-66-29.607-66-66v-108c0-36.393 29.607-66 66-66h108c36.393 0 66 29.607 66 66v108c0 36.393-29.607 66-66 66zm-108-208c-18.748 0-34 15.252-34 34v108c0 18.748 15.252 34 34 34h108c18.748 0 34-15.252 34-34v-108c0-18.748-15.252-34-34-34z"/><path d="m446 240h-108c-36.393 0-66-29.607-66-66v-108c0-36.393 29.607-66 66-66h108c36.393 0 66 29.607 66 66v108c0 36.393-29.607 66-66 66zm-108-208c-18.748 0-34 15.252-34 34v108c0 18.748 15.252 34 34 34h108c18.748 0 34-15.252 34-34v-108c0-18.748-15.252-34-34-34z"/><path d="m392 512c-66.168 0-120-53.832-120-120s53.832-120 120-120 120 53.832 120 120-53.832 120-120 120zm0-208c-48.523 0-88 39.477-88 88s39.477 88 88 88 88-39.477 88-88-39.477-88-88-88z"/><path d="m174 512h-108c-36.393 0-66-29.607-66-66v-108c0-36.393 29.607-66 66-66h108c36.393 0 66 29.607 66 66v108c0 36.393-29.607 66-66 66zm-108-208c-18.748 0-34 15.252-34 34v108c0 18.748 15.252 34 34 34h108c18.748 0 34-15.252 34-34v-108c0-18.748-15.252-34-34-34z"/></g></svg>
						</a>
                            </li>
                            <li class="nav-item dropdown notification_dropdown">
                                <a class="nav-link bell dz-theme-mode" href="javascript:void(0);">
							<i id="icon-light-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></i>
							<i id="icon-dark-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></i>
						</a>
                            </li>
                            <li class="nav-item dropdown notification_dropdown">
                                <a class="nav-link bell dz-fullscreen" href="javascript:void(0);">
							<svg id="icon-full-1" viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" style="stroke-dasharray: 37, 57; stroke-dashoffset: 0;"></path></svg>
							<svg id="icon-minimize-1" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="A098AE" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-minimize"><path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3" style="stroke-dasharray: 37, 57; stroke-dashoffset: 0;"></path></svg>
						</a>
                            </li>

                            <li class="nav-item dropdown notification_dropdown">
                                <a class="nav-link bell-link" href="javascript:void(0);">
							<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#A098AE" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-square"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>						
						</a>
                            </li>
                            <li class="nav-item bell-icon blink dropdown notification_dropdown">
                                <a class="nav-link  " href="javascript:void(0);" role="button" data-bs-toggle="dropdown">
					<svg width="20" height="20" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path d="M25.3677 18.9391V9.86768C25.3677 4.70215 21.1655 0.5 16 0.5C10.8345 0.5 6.63232 4.70215 6.63232 9.86768V18.9397C4.96704 19.4224 3.73828 20.9544 3.73828 22.8374C3.73828 25.0386 5.5293 26.8296 7.73096 26.8296H11.377V26.877C11.377 29.4263 13.4507 31.5 16 31.5C18.5493 31.5 20.6231 29.4263 20.6231 26.8769V26.8296H24.2691C26.4707 26.8296 28.2617 25.0386 28.2617 22.7583C28.2617 20.9406 27.033 19.4198 25.3677 18.9391ZM9.63232 9.86768C9.63232 6.35645 12.4888 3.5 16 3.5C19.5112 3.5 22.3677 6.35645 22.3677 9.86768V18.7661H9.63232V9.86768ZM17.6231 26.8769C17.6231 27.772 16.895 28.5 16 28.5C15.105 28.5 14.377 27.772 14.377 26.8769V26.8296H17.623V26.8769H17.6231ZM24.269 23.8296H7.73096C7.1836 23.8296 6.73828 23.3843 6.73828 22.7583C6.73828 22.2114 7.18359 21.7661 7.73096 21.7661H24.2691C24.8164 21.7661 25.2617 22.2114 25.2617 22.8374C25.2617 23.3843 24.8164 23.8296 24.269 23.8296Z" fill="#A098AE"/>
						</svg>		
						</a>

                        <!--**********************************
	

                                <div class="dropdown-menu dropdown-menu-end of-visible">
                                    <div class="dropdown-header">
                                        <h4 class="title mb-0">Notification</h4>
                                        <a href="javascript:void(0);" class="d-none"><i class="flaticon-381-settings-6"></i></a>
                                    </div>
                                    <div id="DZ_W_Notification1" class="widget-media dlab-scroll p-3" style="height:380px;">
                                        <ul class="timeline">
                                            <li>
                                                <div class="timeline-panel">
                                                    <div class="media me-2">
                                                        <img alt="image" width="50" src="./public/assets/images/avatar/1.jpg">
                                                    </div>
                                                    <div class="media-body">
                                                        <h6 class="mb-1">Dr sultads Send you Photo</h6>
                                                        <small class="d-block">29 July 2020 - 02:26 PM</small>
                                                    </div>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="timeline-panel">
                                                    <div class="media me-2 media-info">
                                                        KG
                                                    </div>
                                                    <div class="media-body">
                                                        <h6 class="mb-1">Resport created successfully</h6>
                                                        <small class="d-block">29 July 2020 - 02:26 PM</small>
                                                    </div>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="timeline-panel">
                                                    <div class="media me-2 media-success">
                                                        <i class="fa fa-home"></i>
                                                    </div>
                                                    <div class="media-body">
                                                        <h6 class="mb-1">Reminder : Treatment Time!</h6>
                                                        <small class="d-block">29 July 2020 - 02:26 PM</small>
                                                    </div>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="timeline-panel">
                                                    <div class="media me-2">
                                                        <img alt="image" width="50" src="./public/assets/images/avatar/1.jpg">
                                                    </div>
                                                    <div class="media-body">
                                                        <h6 class="mb-1">Dr sultads Send you Photo</h6>
                                                        <small class="d-block">29 July 2020 - 02:26 PM</small>
                                                    </div>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="timeline-panel">
                                                    <div class="media me-2 media-danger">
                                                        KG
                                                    </div>
                                                    <div class="media-body">
                                                        <h6 class="mb-1">Resport created successfully</h6>
                                                        <small class="d-block">29 July 2020 - 02:26 PM</small>
                                                    </div>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="timeline-panel">
                                                    <div class="media me-2 media-primary">
                                                        <i class="fa fa-home"></i>
                                                    </div>
                                                    <div class="media-body">
                                                        <h6 class="mb-1">Reminder : Treatment Time!</h6>
                                                        <small class="d-block">29 July 2020 - 02:26 PM</small>
                                                    </div>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                    <a class="all-notification" href="javascript:void(0);">See all notifications <i class="ti-arrow-end"></i></a>
                                </div>
                            </li>
                          
***********************************-->

                            <li class="nav-item dropdown notification_dropdown">
                                <a class="nav-link me-0 " href="javascript:void(0);" data-bs-toggle="dropdown">
							<svg width="20" class="setting-svg" height="20" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path d="M12.2631 2.66667L11.4167 6.46615C10.9353 6.69779 10.4752 6.96458 10.0339 7.26563L6.32035 6.09636L2.58337 12.5703L5.39848 15.1484C5.28849 15.9648 5.33831 16.3672 5.39848 16.8516L2.58337 19.4297L6.32035 25.9037L10.0339 24.7344C10.4752 25.0354 10.9353 25.3022 11.4167 25.5339L12.2631 29.3333H19.737L20.5834 25.5339C21.0647 25.3022 21.5249 25.0354 21.9662 24.7344L25.6797 25.9037L29.4167 19.4297L26.6016 16.8516C26.6246 16.5682 26.6664 16.2845 26.6667 16C26.6678 15.7069 26.6216 15.4108 26.6016 15.1484L29.4167 12.5703L25.6797 6.09636L21.9662 7.26563C21.5249 6.96458 21.0647 6.69779 20.5834 6.46615L19.737 2.66667H12.2631ZM14.4037 5.33334H17.5964L18.2552 8.29167L18.9167 8.55209C19.6649 8.84512 20.3644 9.24846 20.9922 9.75001L21.5495 10.1927L24.4401 9.28386L26.0365 12.0495L23.8021 14.099L23.9089 14.8021C24.0346 15.5797 24.0101 16.4746 23.9089 17.1979L23.8021 17.901L26.0365 19.9505L24.4401 22.7162L21.5495 21.8073L20.9922 22.25C20.3644 22.7516 19.6649 23.1549 18.9167 23.4479L18.2552 23.7083L17.5964 26.6667H14.4037L13.7448 23.7083L13.0834 23.4479C12.3351 23.1549 11.6357 22.7516 11.0079 22.25L10.4506 21.8073L7.55994 22.7162L5.96358 19.9505L8.19796 17.901L8.09119 17.1979C7.96095 16.4046 7.98095 15.4967 8.09119 14.8021L8.19796 14.099L5.96358 12.0495L7.55994 9.28386L10.4506 10.1927L11.0079 9.75001C11.6357 9.24846 12.3351 8.84512 13.0834 8.55209L13.7448 8.29167L14.4037 5.33334ZM16 10.6667C13.0703 10.6667 10.6667 13.0703 10.6667 16C10.6667 18.9297 13.0703 21.3333 16 21.3333C18.9298 21.3333 21.3334 18.9297 21.3334 16C21.3334 13.0703 18.9298 10.6667 16 10.6667ZM16 13.3333C17.4886 13.3333 18.6667 14.5115 18.6667 16C18.6667 17.4886 17.4886 18.6667 16 18.6667C14.5115 18.6667 13.3334 17.4886 13.3334 16C13.3334 14.5115 14.5115 13.3333 16 13.3333Z" fill="#A098AE"/>
							</svg>

						</a>
                                <div class="dropdown-menu dropdown-menu-end">
                                    <div id="DZ_W_TimeLine02" class="widget-timeline dlab-scroll style-1 p-3 height370">
                                        <ul class="timeline">
                                            <li>
                                                <div class="timeline-badge primary"></div>
                                                <a class="timeline-panel text-muted" href="javascript:void(0);">
											<span>10 minutes ago</span>
											<h6 class="mb-0">Youtube, a video-sharing website, goes live <strong class="text-primary">$500</strong>.</h6>
										</a>
                                            </li>
                                            <li>
                                                <div class="timeline-badge info">
                                                </div>
                                                <a class="timeline-panel text-muted" href="javascript:void(0);">
											<span>20 minutes ago</span>
											<h6 class="mb-0">New order placed <strong class="text-info">#XF-2356.</strong></h6>
											<p class="mb-0">Quisque a consequat ante Sit amet magna at volutapt...</p>
										</a>
                                            </li>
                                            <li>
                                                <div class="timeline-badge danger">
                                                </div>
                                                <a class="timeline-panel text-muted" href="javascript:void(0);">
											<span>30 minutes ago</span>
											<h6 class="mb-0">john just buy your product <strong class="text-warning">Sell $250</strong></h6>
										</a>
                                            </li>
                                            <li>
                                                <div class="timeline-badge success">
                                                </div>
                                                <a class="timeline-panel text-muted" href="javascript:void(0);">
											<span>15 minutes ago</span>
											<h6 class="mb-0">StumbleUpon is acquired by eBay. </h6>
										</a>
                                            </li>
                                            <li>
                                                <div class="timeline-badge warning">
                                                </div>
                                                <a class="timeline-panel text-muted" href="javascript:void(0);">
											<span>20 minutes ago</span>
											<h6 class="mb-0">Mashable, a news website and blog, goes live.</h6>
										</a>
                                            </li>
                                            <li>
                                                <div class="timeline-badge dark">
                                                </div>
                                                <a class="timeline-panel text-muted" href="javascript:void(0);">
											<span>20 minutes ago</span>
											<h6 class="mb-0">Mashable, a news website and blog, goes live.</h6>
										</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li class="nav-item">
                                <div class="dropdown header-profile2">
                                    <a class="nav-link ms-0" href="javascript:void(0);" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                        <div class="header-info2 d-flex align-items-center">
                                            <div class="d-flex align-items-center sidebar-info">

                                            </div>
                                            
                                            <img src="./public/assets/images/logo.png" alt="">
                                        </div>
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-end pb-0" style="">
                                        <div class="card mb-0">
                                            <div class="card-header p-3">
                                                <ul class="d-flex align-items-center">
                                                    <li>
                                                        <img src="./public/assets/images/user.jpg" class="ms-0" alt="">
                                                    </li>
                                                    <li class="ms-2">
                                                        <h4 class="mb-0">Nella Vita</h4>
                                                        <span>Admin</span>
                                                    </li>
                                                </ul>

                                            </div>
                                            <div class="card-body p-3">
                                                <a href="./app_profile" class="dropdown-item ai-icon ">
											<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="svg-main-icon">
												<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
													<polygon points="0 0 24 0 24 24 0 24"/>
													<path d="M12,11 C9.790861,11 8,9.209139 8,7 C8,4.790861 9.790861,3 12,3 C14.209139,3 16,4.790861 16,7 C16,9.209139 14.209139,11 12,11 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/>
													<path d="M3.00065168,20.1992055 C3.38825852,15.4265159 7.26191235,13 11.9833413,13 C16.7712164,13 20.7048837,15.2931929 20.9979143,20.2 C21.0095879,20.3954741 20.9979143,21 20.2466999,21 C16.541124,21 11.0347247,21 3.72750223,21 C3.47671215,21 2.97953825,20.45918 3.00065168,20.1992055 Z" fill="var(--primary)" fill-rule="nonzero"/>
												</g>
											</svg>
											<span class="ms-2">Profile </span>
										</a>
                                                <a href="./chat" class="dropdown-item ai-icon ">
											<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="svg-main-icon">
												<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
													<rect x="0" y="0" width="24" height="24"/>
													<path d="M21.9999843,15.009808 L22.0249378,15 L22.0249378,19.5857864 C22.0249378,20.1380712 21.5772226,20.5857864 21.0249378,20.5857864 C20.7597213,20.5857864 20.5053674,20.4804296 20.317831,20.2928932 L18.0249378,18 L5,18 C3.34314575,18 2,16.6568542 2,15 L2,6 C2,4.34314575 3.34314575,3 5,3 L19,3 C20.6568542,3 22,4.34314575 22,6 L22,15 C22,15.0032706 21.9999948,15.0065399 21.9999843,15.009808 Z M6.16794971,10.5547002 C7.67758127,12.8191475 9.64566871,14 12,14 C14.3543313,14 16.3224187,12.8191475 17.8320503,10.5547002 C18.1384028,10.0951715 18.0142289,9.47430216 17.5547002,9.16794971 C17.0951715,8.86159725 16.4743022,8.98577112 16.1679497,9.4452998 C15.0109146,11.1808525 13.6456687,12 12,12 C10.3543313,12 8.9890854,11.1808525 7.83205029,9.4452998 C7.52569784,8.98577112 6.90482849,8.86159725 6.4452998,9.16794971 C5.98577112,9.47430216 5.86159725,10.0951715 6.16794971,10.5547002 Z" fill="var(--primary)"/>
												</g>
											</svg>
											<span class="ms-2">Message </span>
										</a>
                                                <a href="./email_inbox" class="dropdown-item ai-icon ">
											<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="svg-main-icon">
												<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
													<rect x="0" y="0" width="24" height="24"/>
													<path d="M21,12.0829584 C20.6747915,12.0283988 20.3407122,12 20,12 C16.6862915,12 14,14.6862915 14,18 C14,18.3407122 14.0283988,18.6747915 14.0829584,19 L5,19 C3.8954305,19 3,18.1045695 3,17 L3,8 C3,6.8954305 3.8954305,6 5,6 L19,6 C20.1045695,6 21,6.8954305 21,8 L21,12.0829584 Z M18.1444251,7.83964668 L12,11.1481833 L5.85557487,7.83964668 C5.4908718,7.6432681 5.03602525,7.77972206 4.83964668,8.14442513 C4.6432681,8.5091282 4.77972206,8.96397475 5.14442513,9.16035332 L11.6444251,12.6603533 C11.8664074,12.7798822 12.1335926,12.7798822 12.3555749,12.6603533 L18.8555749,9.16035332 C19.2202779,8.96397475 19.3567319,8.5091282 19.1603533,8.14442513 C18.9639747,7.77972206 18.5091282,7.6432681 18.1444251,7.83964668 Z" fill="#000000"/>
													<circle fill="var(--primary)" opacity="0.3" cx="19.5" cy="17.5" r="2.5"/>
												</g>
											</svg>
											<span class="ms-2">Notification </span>
										</a>
                                                <a href="javascript:void(0);" class="dropdown-item ai-icon ">
											<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" class="svg-main-icon">
												<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
													<rect x="0" y="0" width="24" height="24"/>
													<path d="M18.6225,9.75 L18.75,9.75 C19.9926407,9.75 21,10.7573593 21,12 C21,13.2426407 19.9926407,14.25 18.75,14.25 L18.6854912,14.249994 C18.4911876,14.250769 18.3158978,14.366855 18.2393549,14.5454486 C18.1556809,14.7351461 18.1942911,14.948087 18.3278301,15.0846699 L18.372535,15.129375 C18.7950334,15.5514036 19.03243,16.1240792 19.03243,16.72125 C19.03243,17.3184208 18.7950334,17.8910964 18.373125,18.312535 C17.9510964,18.7350334 17.3784208,18.97243 16.78125,18.97243 C16.1840792,18.97243 15.6114036,18.7350334 15.1896699,18.3128301 L15.1505513,18.2736469 C15.008087,18.1342911 14.7951461,18.0956809 14.6054486,18.1793549 C14.426855,18.2558978 14.310769,18.4311876 14.31,18.6225 L14.31,18.75 C14.31,19.9926407 13.3026407,21 12.06,21 C10.8173593,21 9.81,19.9926407 9.81,18.75 C9.80552409,18.4999185 9.67898539,18.3229986 9.44717599,18.2361469 C9.26485393,18.1556809 9.05191298,18.1942911 8.91533009,18.3278301 L8.870625,18.372535 C8.44859642,18.7950334 7.87592081,19.03243 7.27875,19.03243 C6.68157919,19.03243 6.10890358,18.7950334 5.68746499,18.373125 C5.26496665,17.9510964 5.02757002,17.3784208 5.02757002,16.78125 C5.02757002,16.1840792 5.26496665,15.6114036 5.68716991,15.1896699 L5.72635306,15.1505513 C5.86570889,15.008087 5.90431906,14.7951461 5.82064513,14.6054486 C5.74410223,14.426855 5.56881236,14.310769 5.3775,14.31 L5.25,14.31 C4.00735931,14.31 3,13.3026407 3,12.06 C3,10.8173593 4.00735931,9.81 5.25,9.81 C5.50008154,9.80552409 5.67700139,9.67898539 5.76385306,9.44717599 C5.84431906,9.26485393 5.80570889,9.05191298 5.67216991,8.91533009 L5.62746499,8.870625 C5.20496665,8.44859642 4.96757002,7.87592081 4.96757002,7.27875 C4.96757002,6.68157919 5.20496665,6.10890358 5.626875,5.68746499 C6.04890358,5.26496665 6.62157919,5.02757002 7.21875,5.02757002 C7.81592081,5.02757002 8.38859642,5.26496665 8.81033009,5.68716991 L8.84944872,5.72635306 C8.99191298,5.86570889 9.20485393,5.90431906 9.38717599,5.82385306 L9.49484664,5.80114977 C9.65041313,5.71688974 9.7492905,5.55401473 9.75,5.3775 L9.75,5.25 C9.75,4.00735931 10.7573593,3 12,3 C13.2426407,3 14.25,4.00735931 14.25,5.25 L14.249994,5.31450877 C14.250769,5.50881236 14.366855,5.68410223 14.552824,5.76385306 C14.7351461,5.84431906 14.948087,5.80570889 15.0846699,5.67216991 L15.129375,5.62746499 C15.5514036,5.20496665 16.1240792,4.96757002 16.72125,4.96757002 C17.3184208,4.96757002 17.8910964,5.20496665 18.312535,5.626875 C18.7350334,6.04890358 18.97243,6.62157919 18.97243,7.21875 C18.97243,7.81592081 18.7350334,8.38859642 18.3128301,8.81033009 L18.2736469,8.84944872 C18.1342911,8.99191298 18.0956809,9.20485393 18.1761469,9.38717599 L18.1988502,9.49484664 C18.2831103,9.65041313 18.4459853,9.7492905 18.6225,9.75 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/>
													<path d="M12,15 C13.6568542,15 15,13.6568542 15,12 C15,10.3431458 13.6568542,9 12,9 C10.3431458,9 9,10.3431458 9,12 C9,13.6568542 10.3431458,15 12,15 Z" fill="#000000"/>
												</g>
											</svg>
											<span class="ms-2">Settings </span>
										</a>

                                            </div>
                                            <div class="card-footer text-center p-3">
                                                <a href="./page_login" class="dropdown-item ai-icon btn btn-primary light">
											<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
											<span class="ms-2 text-primary">Logout </span>
										</a>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
        <!--**********************************
	Header end 
***********************************-->
         <!--**********************************
    Sidebar start
***********************************-->
<div class="dlabnav">
    <div class="dlabnav-scroll">
        <ul class="metismenu" id="menu">
  <style>
    .nav-text,
    .material-symbols-outlined {
        color: rgb(255, 255, 255) !important;
    }
</style>

<style>
    /* Force both text and icon to black */
    li a.has-arrow .nav-text,
    li a.has-arrow .material-symbols-outlined {
        color: rgb(255, 255, 255) !important;
        fill: rgb(255, 255, 255) !important; /* helps if icons are using SVG fill */
    }
</style>

<li>
    <a class="has-arrow" href="./Dashboard.html" aria-expanded="false">
        <i class="material-symbols-outlined">dashboard</i>
        <span class="nav-text">Dashboard</span>
    </a>
</li>

<li>
    <a class="has-arrow" href="./user managment.html" aria-expanded="false">
        <i class="material-symbols-outlined">manage_accounts</i>
        <span class="nav-text">Manage Users</span>
    </a>
</li>
<li>
    <a class="has-arrow" href="./Customer & Accounts.html" aria-expanded="false">
        <i class="material-symbols-outlined">group</i>
        <span class="nav-text">Customers & Accounts</span>
    </a>
</li>

<li>
    <a class="has-arrow" href="./Rate Card.html" aria-expanded="false">
        <i class="material-symbols-outlined">sell</i>
        <span class="nav-text">Rate Card</span>
    </a>
</li>

<li>
    <a class="has-arrow" href="./Purchase Order.html" aria-expanded="false" onclick="toggleDropdown(this)">
        <i class="material-symbols-outlined">receipt_long</i>
        <span class="nav-text">Purchase Orders</span>
    </a>
</li>

<li>
    <a class="has-arrow" href="./Billing Run.html" aria-expanded="false" onclick="toggleDropdown(this)">
        <i class="material-symbols-outlined">request_quote</i>
        <span class="nav-text">Billing Runs</span>
    </a>
</li>

<li>
    <a class="has-arrow" href="javascript:void(0);" aria-expanded="false" onclick="toggleDropdown(this)">
        <i class="material-symbols-outlined">error_outline</i>
        <span class="nav-text">Exceptions</span>
    </a>
</li>

<li>
    <a class="has-arrow" href="javascript:void(0);" aria-expanded="false" onclick="toggleDropdown(this)">
        <i class="material-symbols-outlined">history</i>
        <span class="nav-text">Audit Log</span>
    </a>
</li>

<li>
    <a class="has-arrow" href="javascript:void(0);" aria-expanded="false" onclick="toggleDropdown(this)">
        <i class="material-symbols-outlined">settings</i>
        <span class="nav-text">Settings</span>
    </a>
</li>


           
        </ul>
    </div>
</div>

        <!--**********************************
    Sidebar end
***********************************-->






















        <!--**********************************
    Content body start
***********************************-->
        <div class="content-body default-height">
            <div class="container-fluid">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@400&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#ffffff;
    --panel:#ffffff;
    --panel-2:#f9f9f9;
    --muted:#555;
    --text:#111;
    --line:#ddd;
    --brand:#5335ff;
    --brand-2:#c3b8fe;
    --radius:10px;
    --shadow:0 2px 6px rgba(0,0,0,.08);
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
    color:var(--text);
    background:var(--bg);
  }

  .topbar{
    display:flex; align-items:center; gap:14px;
    padding:16px 20px;
    border-bottom:1px solid var(--line);
    background:#fff;
    position:sticky; top:0; z-index:100;
  }
  .topbar .back{
    display:inline-flex; align-items:center; justify-content:center;
    width:36px; height:36px; border-radius:6px; border:1px solid var(--line);
    background:#fff; cursor:pointer;
  }
  .title{font-weight:700; font-size:20px}
  .subtitle{color:var(--muted); font-size:13px}
  .spacer{flex:1}
  .btn{
    display:inline-flex; align-items:center; gap:8px; height:36px; padding:0 14px;
    border:1px solid var(--line); border-radius:6px; background:#fff; color:var(--text);
    cursor:pointer; transition:.2s;
  }
  .btn.primary{background:var(--brand); border:none; color:#fff}
  .btn:hover{box-shadow:var(--shadow)}

  .wrap{padding:20px}
  .card{
    background:var(--panel); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow);
  }

  .stepper{
    display:flex; gap:10px; flex-wrap:wrap;
    padding:10px; margin-bottom:14px; background:var(--panel-2);
    border:1px solid var(--line); border-radius:var(--radius);
  }
  .step{
    display:flex; align-items:center; gap:8px; padding:8px 12px;
    border:1px solid var(--line); border-radius:8px; background:#fff; cursor:pointer;
  }
  .step.active{border-color:var(--brand); background:#f0f0ff}
  .badge{
    width:24px; height:24px; border-radius:6px; display:grid; place-items:center;
    background:#f5f5f5; color:var(--text); font-weight:600; font-size:13px;
  }
  .step.active .badge{background:var(--brand); color:#fff}
  .label{font-weight:600; font-size:13px}

  .grid{display:grid; grid-template-columns:1.5fr .8fr; gap:16px}
  @media (max-width:900px){.grid{grid-template-columns:1fr}}

  .panel{padding:18px}
  .panel h3{margin:0 0 6px; font-size:18px}
  .panel .hint{color:var(--muted); font-size:13px; margin-bottom:16px}

  .field{margin-bottom:14px}
  .label{font-size:13px; color:var(--muted); margin-bottom:6px}
  select,.input{
    width:100%; height:38px; padding:0 10px; color:var(--text);
    background:#fff; border:1px solid var(--line); border-radius:6px;
  }

  .list{border:1px solid var(--line); border-radius:6px; overflow:hidden}
  .row{
    display:grid; grid-template-columns:auto 1fr auto auto; gap:10px; align-items:center;
    padding:10px 12px; border-top:1px solid var(--line); background:#fff;
  }
  .row:first-child{border-top:none}
  .radio{accent-color:var(--brand)}
  .acct-title{font-weight:600}
  .acct-sub{color:var(--muted); font-size:12px}
  .pill{
    font-size:12px; padding:4px 8px; border-radius:20px; background:#f5f5f5; border:1px solid var(--line);
  }
  .currency{font-size:12px; color:var(--muted)}

  .summary{padding:18px}
  .summary h4{margin:0 0 12px}
  .kv{display:grid; grid-template-columns:120px 1fr; gap:8px; padding:8px 0; border-bottom:1px dashed #ddd; font-size:14px}
  .kv:last-child{border-bottom:none}
  .muted{color:var(--muted)}
  .placeholder{
    display:grid; place-items:center; min-height:100px; border:1px dashed #ccc; border-radius:6px; color:var(--muted); font-size:13px; background:#fafafa;
  }

  .footer{display:flex; gap:10px; justify-content:flex-end; margin-top:16px}
  .hide{display:none !important}
</style>


<div class="topbar">
  
  <div>
    <div class="title">Create Billing Run</div>
    <div class="subtitle">Step-by-step wizard to generate billing files from ticket data</div>
  </div>
  <div class="spacer"></div>
  <button class="btn">Save Draft</button>
  <button class="btn primary">Continue</button>
</div>

<div class="wrap">
  <div class="stepper" id="stepper">
    <div class="step active" data-step="1"><div class="badge">1</div><div class="label">Ticket Data Distribution</div></div>
    <div class="step" data-step="2"><div class="badge">2</div><div class="label">Rate Card Assignment</div></div>
    <div class="step" data-step="3"><div class="badge">3</div><div class="label">Manual Computation and Verification</div></div>
    <div class="step" data-step="4"><div class="badge">4</div><div class="label">Consolidation</div></div>
    <div class="step" data-step="5"><div class="badge">5</div><div class="label">Review and Monitoring</div></div>
    <div class="step" data-step="5"><div class="badge">6</div><div class="label">Query resolution & resubmission</div></div>
    <div class="step" data-step="5"><div class="badge">7</div><div class="label">Final approval & Invoice Preparation</div></div>
  </div>

  <div id="steps">
   
 <!-- STEP 1 - Ticket Upload & Validation Dashboard -->
<section class="ticket-upload-validation" data-step="1">
    <div class="section-header">
        <div class="header-main">
            <h2><i class="fas fa-file-upload"></i> Ticket Upload & Validation</h2>
            <div class="header-subtitle">
                <span class="badge step-badge">Step 1 of 4</span>
                <p>SDM uploads regional ticket files for system validation and distribution</p>
            </div>
        </div>
        <div class="header-actions">
            <button class="btn-icon-outline" title="Help">
                <i class="fas fa-question-circle"></i>
            </button>
            <button class="btn-icon-outline" title="Refresh">
                <i class="fas fa-sync-alt"></i>
            </button>
        </div>
    </div>
    
    <!-- Data Sources Info -->
    <div class="data-sources-card">
        <h3><i class="fas fa-database"></i> Data Sources for Validation</h3>
        <div class="sources-grid">
            <div class="source-item">
                <div class="source-icon">
                    <i class="fas fa-file-excel"></i>
                </div>
                <div class="source-content">
                    <h4>Regional Ticket Files</h4>
                    <p><strong>Source:</strong> SDM Teams</p>
                    <p><strong>Format:</strong> Excel (.xlsx, .xls)</p>
                    <p><strong>Purpose:</strong> Ticket-level service data</p>
                </div>
            </div>
            <div class="source-item">
                <div class="source-icon">
                    <i class="fas fa-file-pdf"></i>
                </div>
                <div class="source-content">
                    <h4>Ticket Evidence</h4>
                    <p><strong>Source:</strong> SDM / SharePoint</p>
                    <p><strong>Format:</strong> PDF / ZIP</p>
                    <p><strong>Purpose:</strong> Proof/documentation</p>
                </div>
            </div>
            <div class="source-item">
                <div class="source-icon">
                    <i class="fas fa-file-alt"></i>
                </div>
                <div class="source-content">
                    <h4>Validation Rules</h4>
                    <p><strong>Source:</strong> Internal</p>
                    <p><strong>Format:</strong> Excel Template</p>
                    <p><strong>Purpose:</strong> Check ticket formatting</p>
                </div>
            </div>
            <div class="source-item">
                <div class="source-icon">
                    <i class="fas fa-history"></i>
                </div>
                <div class="source-content">
                    <h4>Prior Cycle Data</h4>
                    <p><strong>Source:</strong> Dashboard</p>
                    <p><strong>Format:</strong> Stored / CSV</p>
                    <p><strong>Purpose:</strong> Reconciliation</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main Dashboard -->
    <div class="dashboard-grid">
        <!-- Left Panel: Upload & Controls -->
        <div class="left-panel">
            <div class="upload-card">
                <div class="upload-header">
                    <h3><i class="fas fa-cloud-upload-alt"></i> Upload Ticket Files</h3>
                    <span class="upload-info">Max file size: 50MB</span>
                </div>
                
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">
                        <i class="fas fa-file-excel"></i>
                    </div>
                    <h4>Drop Excel/CSV files here</h4>
                    <p>or click to browse</p>
                    <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" multiple style="display: none;">
                    <button class="btn-primary" id="browseBtn">
                        <i class="fas fa-folder-open"></i> Select Files
                    </button>
                    <div class="file-types">
                        <span>.xlsx</span>
                        <span>.xls</span>
                        <span>.csv</span>
                    </div>
                </div>
                
                <div class="upload-progress" id="uploadProgress" style="display: none;">
                    <div class="progress-header">
                        <span>Uploading files...</span>
                        <span class="progress-percent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="uploaded-files" id="uploadedFiles">
                    <!-- Files will be listed here -->
                </div>
            </div>
            
            <div class="validation-card">
                <h3><i class="fas fa-check-circle"></i> Validation Controls</h3>
                <div class="validation-options">
                    <div class="option-item">
                        <input type="checkbox" id="checkFormat" checked>
                        <label for="checkFormat">Validate file format</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="checkRequired" checked>
                        <label for="checkRequired">Check required fields</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="checkDuplicates" checked>
                        <label for="checkDuplicates">Detect duplicates</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="checkReferences" checked>
                        <label for="checkReferences">Validate references</label>
                    </div>
                </div>
                
                <div class="validation-actions">
                    <button class="btn-secondary full-width" id="validateFilesBtn" disabled>
                        <i class="fas fa-play-circle"></i> Run Validation
                    </button>
                    <button class="btn-tertiary full-width" id="loadSampleDataBtn">
                        <i class="fas fa-database"></i> Load Sample Data
                    </button>
                </div>
                
                <div class="validation-stats" id="validationStats">
                    <div class="stat-row">
                        <span>Files to validate:</span>
                        <span class="stat-value" id="fileCount">0</span>
                    </div>
                    <div class="stat-row">
                        <span>Estimated time:</span>
                        <span class="stat-value" id="estTime">0s</span>
                    </div>
                </div>
            </div>
            
            <div class="distribution-card">
                <h3><i class="fas fa-paper-plane"></i> Distribution Setup</h3>
                <div class="distribution-options">
                    <div class="dist-option">
                        <label>Distribution Method</label>
                        <select id="distMethod">
                            <option value="auto">Automatic (System)</option>
                            <option value="manual">Manual Review</option>
                            <option value="scheduled">Scheduled</option>
                        </select>
                    </div>
                    <div class="dist-option">
                        <label>Priority Level</label>
                        <select id="priorityLevel">
                            <option value="normal">Normal</option>
                            <option value="high">High Priority</option>
                            <option value="urgent">Urgent</option>
                        </select>
                    </div>
                </div>
                
                <button class="btn-success full-width" id="startDistributionBtn" disabled>
                    <i class="fas fa-rocket"></i> Start Distribution
                </button>
            </div>
        </div>
        
        <!-- Right Panel: Results & Analytics -->
        <div class="right-panel">
            <!-- Tabs Navigation -->
            <div class="results-tabs">
                <button class="tab-btn active" data-tab="validation">Validation Results</button>
                <button class="tab-btn" data-tab="analytics">Analytics</button>
                <button class="tab-btn" data-tab="distribution">Distribution Status</button>
            </div>
            
            <!-- Validation Results Tab -->
            <div class="tab-content active" id="validationTab">
                <div class="results-header">
                    <h3><i class="fas fa-clipboard-check"></i> Validation Results</h3>
                    <div class="results-actions">
                        <div class="view-toggle">
                            <button class="view-btn active" data-view="table">
                                <i class="fas fa-table"></i> Table
                            </button>
                            <button class="view-btn" data-view="form">
                                <i class="fas fa-file-alt"></i> Form
                            </button>
                        </div>
                        <div class="table-controls">
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="tableSearch" placeholder="Search tickets...">
                            </div>
                            <button class="btn-icon-sm" id="columnToggleBtn" title="Columns">
                                <i class="fas fa-columns"></i>
                            </button>
                            <button class="btn-icon-sm" title="Export Results">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="btn-icon-sm" title="Print">
                                <i class="fas fa-print"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="validation-summary">
                    <div class="summary-item success">
                        <div class="summary-value" id="validCount">0</div>
                        <div class="summary-label">Valid Tickets</div>
                    </div>
                    <div class="summary-item warning">
                        <div class="summary-value" id="warningCount">0</div>
                        <div class="summary-label">Warnings</div>
                    </div>
                    <div class="summary-item error">
                        <div class="summary-value" id="errorCount">0</div>
                        <div class="summary-label">Errors</div>
                    </div>
                    <div class="summary-item total">
                        <div class="summary-value" id="totalCount">0</div>
                        <div class="summary-label">Total Tickets</div>
                    </div>
                </div>
                
                <!-- Table View -->
                <div class="data-view active" id="tableView">
                    <div class="table-container-wrapper">
                        <div class="table-container">
                            <table class="validation-table" id="ticketDataTable">
                                <thead id="tableHeader">
                                    <!-- Dynamic headers will be inserted here -->
                                </thead>
                                <tbody id="tableBody">
                                    <!-- Dynamic data will be inserted here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Pagination -->
                    <div class="pagination-controls" id="paginationControls">
                        <div class="pagination-info">
                            Showing <span id="startRow">0</span>-<span id="endRow">0</span> of <span id="totalRows">0</span> tickets
                        </div>
                        <div class="pagination-buttons">
                            <button class="pagination-btn" id="firstPage" disabled>
                                <i class="fas fa-angle-double-left"></i>
                            </button>
                            <button class="pagination-btn" id="prevPage" disabled>
                                <i class="fas fa-angle-left"></i>
                            </button>
                            <div class="page-numbers" id="pageNumbers"></div>
                            <button class="pagination-btn" id="nextPage" disabled>
                                <i class="fas fa-angle-right"></i>
                            </button>
                            <button class="pagination-btn" id="lastPage" disabled>
                                <i class="fas fa-angle-double-right"></i>
                            </button>
                        </div>
                        <div class="rows-per-page">
                            <select id="rowsPerPage">
                                <option value="10">10 rows</option>
                                <option value="25" selected>25 rows</option>
                                <option value="50">50 rows</option>
                                <option value="100">100 rows</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Form View -->
                <div class="data-view" id="formView">
                    <div class="form-navigation">
                        <button class="form-nav-btn" id="prevTicket" disabled>
                            <i class="fas fa-chevron-left"></i> Previous
                        </button>
                        <div class="form-counter">
                            Ticket <span id="currentTicketIndex">0</span> of <span id="totalTicketsForm">0</span>
                        </div>
                        <button class="form-nav-btn" id="nextTicket" disabled>
                            Next <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    
                    <div class="ticket-form" id="ticketForm">
                        <!-- Dynamic form will be inserted here -->
                    </div>
                </div>
            </div>
            
            <!-- Analytics Tab -->
            <div class="tab-content" id="analyticsTab">
                <div class="analytics-header">
                    <h3><i class="fas fa-chart-bar"></i> Ticket Analytics</h3>
                    <div class="date-filter">
                        <select id="timePeriod">
                            <option value="today">Today</option>
                            <option value="week">This Week</option>
                            <option value="month" selected>This Month</option>
                            <option value="quarter">This Quarter</option>
                        </select>
                    </div>
                </div>
                
                <div class="analytics-grid">
                    <div class="chart-container">
                        <div class="chart-header">
                            <h4>Regional Distribution</h4>
                            <button class="btn-icon-xs" id="refreshChart">
                                <i class="fas fa-redo"></i>
                            </button>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="regionChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-header">
                            <h4>Ticket Types</h4>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="typeChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="stats-container">
                        <h4>Quick Stats</h4>
                        <div class="stats-list">
                            <div class="stat-item-large">
                                <div class="stat-icon">
                                    <i class="fas fa-ticket-alt"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value" id="totalTicketsStat">0</div>
                                    <div class="stat-label">Total Tickets</div>
                                </div>
                            </div>
                            <div class="stat-item-large">
                                <div class="stat-icon success">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value" id="validTicketsStat">0</div>
                                    <div class="stat-label">Validated</div>
                                </div>
                            </div>
                            <div class="stat-item-large">
                                <div class="stat-icon pending">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value" id="pendingTicketsStat">0</div>
                                    <div class="stat-label">Pending</div>
                                </div>
                            </div>
                            <div class="stat-item-large">
                                <div class="stat-icon warning">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value" id="warningTicketsStat">0</div>
                                    <div class="stat-label">With Warnings</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Distribution Tab -->
            <div class="tab-content" id="distributionTab">
                <div class="distribution-header">
                    <h3><i class="fas fa-network-wired"></i> Distribution Status</h3>
                    <div class="dist-actions">
                        <button class="btn-icon-sm" title="Pause Distribution">
                            <i class="fas fa-pause"></i>
                        </button>
                        <button class="btn-icon-sm" title="Force Retry">
                            <i class="fas fa-redo"></i>
                        </button>
                    </div>
                </div>
                
                <div class="distribution-progress">
                    <div class="progress-info">
                        <div class="progress-title">
                            <span>System Distribution Progress</span>
                            <span class="progress-percent-large">0%</span>
                        </div>
                        <div class="progress-bar-large">
                            <div class="progress-fill-large" style="width: 0%"></div>
                        </div>
                        <div class="progress-details">
                            <span>Processing: <strong id="currentRegion">-</strong></span>
                            <span>Tickets: <strong id="processedTickets">0</strong> of <strong id="totalTickets">0</strong></span>
                        </div>
                    </div>
                </div>
                
                <div class="distribution-table-container">
                    <table class="distribution-table">
                        <thead>
                            <tr>
                                <th>Region</th>
                                <th>Status</th>
                                <th>Tickets</th>
                                <th>Started</th>
                                <th>Completed</th>
                                <th>Duration</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody id="distributionTableBody">
                            <!-- Distribution status will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Floating Window for Ticket Details (Hidden by default) -->
    <div class="floating-window" id="ticketDetailsWindow">
        <div class="floating-header">
            <h3><i class="fas fa-ticket-alt"></i> Ticket Details</h3>
            <button class="close-btn" id="closeDetailsWindow">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="floating-content" id="ticketDetailsContent">
            <!-- Ticket details will be loaded here -->
        </div>
    </div>
    
    <!-- Column Configuration Modal -->
    <div class="modal-overlay" id="columnConfigModal" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h3><i class="fas fa-columns"></i> Configure Columns</h3>
                <button class="close-btn" id="closeColumnModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="column-categories">
                    <div class="category-section">
                        <h4><i class="fas fa-info-circle"></i> Basic Information</h4>
                        <div class="column-list" id="basicColumns"></div>
                    </div>
                    <div class="category-section">
                        <h4><i class="fas fa-calendar-alt"></i> Date & Time</h4>
                        <div class="column-list" id="dateColumns"></div>
                    </div>
                    <div class="category-section">
                        <h4><i class="fas fa-dollar-sign"></i> Cost & Billing</h4>
                        <div class="column-list" id="costColumns"></div>
                    </div>
                    <div class="category-section">
                        <h4><i class="fas fa-cogs"></i> Service Details</h4>
                        <div class="column-list" id="serviceColumns"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="resetColumns">Reset to Default</button>
                <button class="btn-primary" id="applyColumns">Apply Changes</button>
            </div>
        </div>
    </div>
    
    <style>
        /* STEP 1 - Ticket Upload & Validation */
        .ticket-upload-validation {
            background: #ffffff;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid #eaeaea;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f2f5;
        }
        
        .header-main h2 {
            color: #1a365d;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .header-main h2 i {
            color: #4299e1;
        }
        
        .header-subtitle {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .step-badge {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }
        
        .header-subtitle p {
            color: #718096;
            font-size: 14px;
            margin: 0;
        }
        
        .header-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-icon-outline {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: 1.5px solid #e2e8f0;
            background: white;
            color: #4a5568;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .btn-icon-outline:hover {
            border-color: #4299e1;
            color: #4299e1;
            transform: translateY(-2px);
        }
        
        /* Data Sources Card */
        .data-sources-card {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid #e2e8f0;
        }
        
        .data-sources-card h3 {
            color: #2d3748;
            font-size: 18px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .source-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            display: flex;
            gap: 15px;
            align-items: flex-start;
            border: 1px solid #e2e8f0;
            transition: all 0.3s;
        }
        
        .source-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            border-color: #4299e1;
        }
        
        .source-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .source-content h4 {
            color: #2d3748;
            font-size: 16px;
            margin-bottom: 8px;
        }
        
        .source-content p {
            color: #718096;
            font-size: 13px;
            margin-bottom: 4px;
        }
        
        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 380px 1fr;
            gap: 30px;
        }
        
        /* Left Panel Styles */
        .upload-card, .validation-card, .distribution-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.04);
        }
        
        .upload-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .upload-header h3 {
            color: #2d3748;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .upload-info {
            background: #e6f7ff;
            color: #1890ff;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .upload-area {
            border: 2px dashed #cbd5e0;
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            background: #fafbfc;
            margin-bottom: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .upload-area:hover, .upload-area.drag-over {
            border-color: #4299e1;
            background: #f0f9ff;
        }
        
        .upload-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #e6fffa, #b2f5ea);
            color: #234e52;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 28px;
        }
        
        .upload-area h4 {
            color: #2d3748;
            margin-bottom: 8px;
            font-size: 18px;
        }
        
        .upload-area p {
            color: #718096;
            margin-bottom: 20px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(66, 153, 225, 0.3);
        }
        
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .file-types {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }
        
        .file-types span {
            background: #edf2f7;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            color: #4a5568;
        }
        
        .upload-progress {
            margin: 20px 0;
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
            color: #4a5568;
        }
        
        .progress-bar {
            height: 6px;
            background: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78, #38a169);
            transition: width 0.3s;
        }
        
        .uploaded-files {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            background: #f7fafc;
            border-radius: 8px;
            margin-bottom: 8px;
            border: 1px solid #e2e8f0;
        }
        
        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .file-icon {
            color: #4299e1;
            font-size: 16px;
        }
        
        .file-name {
            font-weight: 500;
            color: #2d3748;
        }
        
        .file-size {
            font-size: 12px;
            color: #718096;
        }
        
        .file-status {
            font-size: 12px;
            padding: 3px 10px;
            border-radius: 12px;
            font-weight: 500;
        }
        
        .status-uploaded {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .status-error {
            background: #fed7d7;
            color: #742a2a;
        }
        
        /* Validation Options */
        .validation-options {
            margin: 20px 0;
        }
        
        .option-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }
        
        .option-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #4299e1;
        }
        
        .option-item label {
            color: #4a5568;
            font-size: 14px;
            cursor: pointer;
        }
        
        .validation-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .btn-secondary {
            background: #718096;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            width: 100%;
            justify-content: center;
        }
        
        .btn-secondary:hover:not(:disabled) {
            background: #4a5568;
            transform: translateY(-2px);
        }
        
        .btn-secondary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .btn-tertiary {
            background: #edf2f7;
            color: #4a5568;
            border: 1px solid #cbd5e0;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            width: 100%;
            justify-content: center;
        }
        
        .btn-tertiary:hover {
            background: #e2e8f0;
            border-color: #a0aec0;
            transform: translateY(-2px);
        }
        
        .full-width {
            width: 100%;
        }
        
        .validation-stats {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }
        
        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .stat-value {
            font-weight: 600;
            color: #2d3748;
        }
        
        /* Distribution Options */
        .distribution-options {
            margin: 20px 0;
        }
        
        .dist-option {
            margin-bottom: 15px;
        }
        
        .dist-option label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #4a5568;
            font-size: 14px;
        }
        
        select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #cbd5e0;
            border-radius: 8px;
            background: white;
            color: #2d3748;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-success:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(72, 187, 120, 0.3);
        }
        
        /* Right Panel Styles */
        .results-tabs {
            display: flex;
            gap: 2px;
            background: #edf2f7;
            padding: 4px;
            border-radius: 10px;
            margin-bottom: 25px;
        }
        
        .tab-btn {
            flex: 1;
            padding: 12px 16px;
            border: none;
            background: transparent;
            color: #718096;
            font-weight: 600;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
        }
        
        .tab-btn.active {
            background: white;
            color: #4299e1;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .results-header h3 {
            color: #2d3748;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .results-actions {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .view-toggle {
            display: flex;
            background: #edf2f7;
            padding: 4px;
            border-radius: 8px;
        }
        
        .view-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: #718096;
            font-weight: 500;
            cursor: pointer;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }
        
        .view-btn.active {
            background: white;
            color: #4299e1;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
        }
        
        .table-controls {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .search-box {
            position: relative;
            width: 200px;
        }
        
        .search-box i {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #a0aec0;
        }
        
        .search-box input {
            width: 100%;
            padding: 10px 12px 10px 36px;
            border: 1px solid #cbd5e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }
        
        .btn-icon-sm {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            background: white;
            color: #718096;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .btn-icon-sm:hover {
            border-color: #4299e1;
            color: #4299e1;
        }
        
        .validation-summary {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .summary-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        
        .summary-item.success {
            border-top: 4px solid #48bb78;
        }
        
        .summary-item.warning {
            border-top: 4px solid #ed8936;
        }
        
        .summary-item.error {
            border-top: 4px solid #f56565;
        }
        
        .summary-item.total {
            border-top: 4px solid #4299e1;
        }
        
        .summary-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .summary-item.success .summary-value {
            color: #48bb78;
        }
        
        .summary-item.warning .summary-value {
            color: #ed8936;
        }
        
        .summary-item.error .summary-value {
            color: #f56565;
        }
        
        .summary-item.total .summary-value {
            color: #4299e1;
        }
        
        .summary-label {
            color: #718096;
            font-size: 13px;
            font-weight: 500;
        }
        
        /* Data Views */
        .data-view {
            display: none;
        }
        
        .data-view.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        /* Table View */
        .table-container-wrapper {
            overflow-x: auto;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            background: white;
            margin-bottom: 20px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .validation-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            min-width: 1200px;
        }
        
        .validation-table thead {
            background: #f7fafc;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .validation-table th {
            padding: 14px 12px;
            text-align: left;
            font-weight: 600;
            color: #4a5568;
            border-bottom: 2px solid #e2e8f0;
            white-space: nowrap;
            position: relative;
        }
        
        .validation-table th.sortable {
            cursor: pointer;
        }
        
        .validation-table th.sortable:hover {
            background: #edf2f7;
        }
        
        .validation-table th .sort-icon {
            margin-left: 4px;
            opacity: 0.5;
        }
        
        .validation-table th.sort-asc .sort-icon,
        .validation-table th.sort-desc .sort-icon {
            opacity: 1;
            color: #4299e1;
        }
        
        .validation-table td {
            padding: 12px;
            border-bottom: 1px solid #edf2f7;
            vertical-align: top;
        }
        
        .validation-table tbody tr:hover {
            background: #f7fafc;
        }
        
        .status-cell {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-valid {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .status-warning {
            background: #feebc8;
            color: #744210;
        }
        
        .status-error {
            background: #fed7d7;
            color: #742a2a;
        }
        
        /* Pagination */
        .pagination-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: white;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .pagination-info {
            color: #718096;
            font-size: 14px;
        }
        
        .pagination-buttons {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .pagination-btn {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            background: white;
            color: #4a5568;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .pagination-btn:hover:not(:disabled) {
            border-color: #4299e1;
            color: #4299e1;
        }
        
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .page-numbers {
            display: flex;
            gap: 2px;
        }
        
        .page-number {
            min-width: 36px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            background: white;
            color: #4a5568;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .page-number:hover {
            border-color: #4299e1;
            color: #4299e1;
        }
        
        .page-number.active {
            background: #4299e1;
            color: white;
            border-color: #4299e1;
        }
        
        .rows-per-page select {
            width: auto;
            padding: 8px 12px;
        }
        
        /* Form View */
        .form-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px 20px;
            background: white;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }
        
        .form-nav-btn {
            padding: 10px 20px;
            border: 1px solid #cbd5e0;
            background: white;
            color: #4a5568;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .form-nav-btn:hover:not(:disabled) {
            border-color: #4299e1;
            color: #4299e1;
        }
        
        .form-nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .form-counter {
            font-weight: 600;
            color: #2d3748;
        }
        
        .ticket-form {
            background: white;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            padding: 25px;
        }
        
        .form-section {
            margin-bottom: 30px;
        }
        
        .form-section h4 {
            color: #2d3748;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f2f5;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .form-field {
            margin-bottom: 15px;
        }
        
        .form-field label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #4a5568;
            font-size: 14px;
        }
        
        .form-field .field-value {
            padding: 10px 12px;
            background: #f7fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            color: #2d3748;
            min-height: 40px;
            display: flex;
            align-items: center;
        }
        
        .form-field .field-value.empty {
            color: #a0aec0;
            font-style: italic;
        }
        
        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-container {
            background: white;
            border-radius: 16px;
            width: 800px;
            max-width: 90%;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            background: linear-gradient(135deg, #1a365d, #2d3748);
            color: white;
        }
        
        .modal-header h3 {
            margin: 0;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .modal-body {
            padding: 25px;
            overflow-y: auto;
            flex: 1;
        }
        
        .modal-footer {
            padding: 20px 25px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        
        .column-categories {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .category-section h4 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .column-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 12px;
        }
        
        .column-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            background: #f7fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s;
        }
        
        .column-item:hover {
            background: #edf2f7;
        }
        
        .column-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: #4299e1;
        }
        
        .column-item label {
            flex: 1;
            color: #4a5568;
            font-size: 14px;
            cursor: pointer;
            user-select: none;
        }
        
        /* Analytics Tab */
        .analytics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .analytics-header h3 {
            color: #2d3748;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .analytics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.04);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .chart-header h4 {
            color: #2d3748;
            font-size: 16px;
            font-weight: 600;
        }
        
        .btn-icon-xs {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            background: white;
            color: #718096;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .btn-icon-xs:hover {
            border-color: #4299e1;
            color: #4299e1;
        }
        
        .chart-wrapper {
            height: 250px;
            position: relative;
        }
        
        .stats-container {
            grid-column: span 2;
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.04);
        }
        
        .stats-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .stat-item-large {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }
        
        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .stat-icon.success {
            background: linear-gradient(135deg, #48bb78, #38a169);
        }
        
        .stat-icon.pending {
            background: linear-gradient(135deg, #ed8936, #dd6b20);
        }
        
        .stat-icon.warning {
            background: linear-gradient(135deg, #ecc94b, #d69e2e);
        }
        
        .stat-content .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 4px;
        }
        
        .stat-content .stat-label {
            color: #718096;
            font-size: 14px;
        }
        
        /* Distribution Progress */
        .distribution-progress {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.04);
        }
        
        .progress-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .progress-title span:first-child {
            color: #2d3748;
            font-weight: 600;
        }
        
        .progress-percent-large {
            font-size: 24px;
            font-weight: 700;
            color: #4299e1;
        }
        
        .progress-bar-large {
            height: 10px;
            background: #e2e8f0;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .progress-fill-large {
            height: 100%;
            background: linear-gradient(90deg, #4299e1, #3182ce);
            transition: width 0.5s ease;
        }
        
        .progress-details {
            display: flex;
            justify-content: space-between;
            color: #718096;
            font-size: 14px;
        }
        
        .progress-details strong {
            color: #2d3748;
        }
        
        /* Floating Window */
        .floating-window {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 700px;
            max-width: 90%;
            max-height: 80vh;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            display: none;
            flex-direction: column;
            overflow: hidden;
            animation: windowAppear 0.3s ease;
        }
        
        @keyframes windowAppear {
            from {
                opacity: 0;
                transform: translate(-50%, -40%);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }
        
        .floating-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            background: linear-gradient(135deg, #1a365d, #2d3748);
            color: white;
        }
        
        .floating-header h3 {
            margin: 0;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .floating-content {
            padding: 25px;
            overflow-y: auto;
            flex: 1;
        }
        
        /* Responsive Design */
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .analytics-grid {
                grid-template-columns: 1fr;
            }
            
            .validation-summary {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .results-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .table-controls {
                flex: 1;
                justify-content: flex-end;
            }
        }
        
        @media (max-width: 768px) {
            .section-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .header-subtitle {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .sources-grid {
                grid-template-columns: 1fr;
            }
            
            .validation-summary {
                grid-template-columns: 1fr;
            }
            
            .stats-list {
                grid-template-columns: 1fr;
            }
            
            .results-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .results-actions {
                flex-direction: column;
                gap: 10px;
            }
            
            .table-controls {
                width: 100%;
                justify-content: space-between;
            }
            
            .search-box {
                flex: 1;
                min-width: 150px;
            }
            
            .pagination-controls {
                flex-direction: column;
                gap: 15px;
            }
            
            .pagination-buttons {
                order: 1;
            }
            
            .pagination-info {
                order: 2;
            }
            
            .rows-per-page {
                order: 3;
            }
            
            .form-navigation {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
    
    <script>
        // Wait for DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize state
            let uploadedFiles = [];
            let validationResults = [];
            let distributionStatus = [];
            let sampleData = [];
            let currentView = 'table';
            let currentPage = 1;
            let rowsPerPage = 25;
            let totalPages = 1;
            let sortColumn = null;
            let sortDirection = 'asc';
            let currentFormIndex = 0;
            let columnVisibility = {};
            let columnDefinitions = [];
            
            // DOM Elements
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const browseBtn = document.getElementById('browseBtn');
            const uploadProgress = document.getElementById('uploadProgress');
            const uploadedFilesDiv = document.getElementById('uploadedFiles');
            const validateFilesBtn = document.getElementById('validateFilesBtn');
            const startDistributionBtn = document.getElementById('startDistributionBtn');
            const fileCount = document.getElementById('fileCount');
            const ticketDetailsWindow = document.getElementById('ticketDetailsWindow');
            const closeDetailsWindow = document.getElementById('closeDetailsWindow');
            const ticketDetailsContent = document.getElementById('ticketDetailsContent');
            const loadSampleDataBtn = document.getElementById('loadSampleDataBtn');
            const columnConfigModal = document.getElementById('columnConfigModal');
            const closeColumnModal = document.getElementById('closeColumnModal');
            const resetColumnsBtn = document.getElementById('resetColumns');
            const applyColumnsBtn = document.getElementById('applyColumns');
            const columnToggleBtn = document.getElementById('columnToggleBtn');
            const tableSearch = document.getElementById('tableSearch');
            const rowsPerPageSelect = document.getElementById('rowsPerPage');
            const prevPageBtn = document.getElementById('prevPage');
            const nextPageBtn = document.getElementById('nextPage');
            const firstPageBtn = document.getElementById('firstPage');
            const lastPageBtn = document.getElementById('lastPage');
            const pageNumbersDiv = document.getElementById('pageNumbers');
            const viewBtns = document.querySelectorAll('.view-btn');
            const prevTicketBtn = document.getElementById('prevTicket');
            const nextTicketBtn = document.getElementById('nextTicket');
            
            // Initialize column definitions
            initializeColumnDefinitions();
            
            // Tab functionality
            const tabBtns = document.querySelectorAll('.tab-btn');
            tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const tabId = btn.getAttribute('data-tab');
                    
                    // Update active tab
                    tabBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    // Show corresponding tab content
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${tabId}Tab`).classList.add('active');
                    
                    // If validation tab, update views
                    if (tabId === 'validation' && validationResults.length > 0) {
                        updateDataViews();
                    }
                });
            });
            
            // View toggle functionality
            viewBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const view = btn.getAttribute('data-view');
                    
                    // Update active view button
                    viewBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    // Show corresponding view
                    document.querySelectorAll('.data-view').forEach(viewElement => {
                        viewElement.classList.remove('active');
                    });
                    document.getElementById(`${view}View`).classList.add('active');
                    
                    currentView = view;
                    
                    // Update form view if needed
                    if (view === 'form' && validationResults.length > 0) {
                        currentFormIndex = 0;
                        updateFormView();
                    }
                });
            });
            
            // File upload functionality
            browseBtn.addEventListener('click', () => {
                fileInput.click();
            });
            
            uploadArea.addEventListener('click', () => {
                fileInput.click();
            });
            
            // Drag and drop functionality
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                uploadArea.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                uploadArea.classList.add('drag-over');
            }
            
            function unhighlight() {
                uploadArea.classList.remove('drag-over');
            }
            
            uploadArea.addEventListener('drop', handleDrop, false);
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFiles(files);
            }
            
            fileInput.addEventListener('change', (e) => {
                handleFiles(e.target.files);
            });
            
            function handleFiles(files) {
                [...files].forEach(file => {
                    uploadFile(file);
                });
            }
            
            function uploadFile(file) {
                const fileId = Date.now() + '-' + Math.random().toString(36).substr(2, 9);
                const fileItem = {
                    id: fileId,
                    name: file.name,
                    size: formatFileSize(file.size),
                    status: 'uploading',
                    progress: 0
                };
                
                uploadedFiles.push(fileItem);
                renderUploadedFiles();
                updateValidationButton();
                
                // Simulate upload progress
                simulateUploadProgress(fileId);
            }
            
            function simulateUploadProgress(fileId) {
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 20;
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(interval);
                        
                        // Update file status
                        const fileIndex = uploadedFiles.findIndex(f => f.id === fileId);
                        if (fileIndex !== -1) {
                            uploadedFiles[fileIndex].status = 'uploaded';
                            uploadedFiles[fileIndex].progress = 100;
                            renderUploadedFiles();
                        }
                        
                        // Check if all files uploaded
                        const allUploaded = uploadedFiles.every(f => f.status === 'uploaded');
                        if (allUploaded) {
                            showNotification('All files uploaded successfully!', 'success');
                        }
                    } else {
                        // Update progress
                        const fileIndex = uploadedFiles.findIndex(f => f.id === fileId);
                        if (fileIndex !== -1) {
                            uploadedFiles[fileIndex].progress = progress;
                            renderUploadedFiles();
                        }
                    }
                }, 200);
            }
            
            function renderUploadedFiles() {
                uploadedFilesDiv.innerHTML = '';
                fileCount.textContent = uploadedFiles.length;
                
                if (uploadedFiles.length === 0) {
                    uploadedFilesDiv.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>No files uploaded yet</p>
                        </div>
                    `;
                    return;
                }
                
                uploadedFiles.forEach(file => {
                    const fileDiv = document.createElement('div');
                    fileDiv.className = 'file-item';
                    fileDiv.innerHTML = `
                        <div class="file-info">
                            <i class="fas fa-file-excel file-icon"></i>
                            <div>
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${file.size}</div>
                            </div>
                        </div>
                        <div>
                            <span class="file-status ${file.status === 'uploaded' ? 'status-uploaded' : ''}">
                                ${file.status === 'uploaded' ? 'Ready' : 'Uploading...'}
                            </span>
                        </div>
                    `;
                    
                    if (file.status !== 'uploaded') {
                        const progressBar = document.createElement('div');
                        progressBar.className = 'progress-bar';
                        progressBar.style.marginTop = '8px';
                        progressBar.style.height = '4px';
                        const progressFill = document.createElement('div');
                        progressFill.className = 'progress-fill';
                        progressFill.style.width = `${file.progress}%`;
                        progressBar.appendChild(progressFill);
                        fileDiv.querySelector('.file-info').parentNode.insertBefore(
                            progressBar,
                            fileDiv.querySelector('.file-info').nextSibling
                        );
                    }
                    
                    uploadedFilesDiv.appendChild(fileDiv);
                });
            }
            
            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            function updateValidationButton() {
                const hasUploadedFiles = uploadedFiles.some(f => f.status === 'uploaded');
                validateFilesBtn.disabled = !hasUploadedFiles;
                startDistributionBtn.disabled = true; // Reset until validation
            }
            
            // Sample data functionality
            loadSampleDataBtn.addEventListener('click', () => {
                loadSampleData();
            });
            
            function loadSampleData() {
                showNotification('Loading sample data...', 'info');
                
                // Generate sample data based on the provided structure
                sampleData = generateSampleData();
                
                // Process as validation results
                validationResults = processSampleData(sampleData);
                
                // Update UI
                updateValidationSummary();
                updateDataViews();
                updateAnalytics();
                
                // Enable distribution button
                startDistributionBtn.disabled = false;
                
                // Switch to validation tab
                document.querySelector('[data-tab="validation"]').click();
                
                showNotification('Sample data loaded successfully!', 'success');
            }
            
            function generateSampleData() {
                // Based on the provided sample data structure
                return [
                    {
                        "Site Category": "Dispatch",
                        "Customer Name": "Caterpillar",
                        "Partner Name": "Excis",
                        "Customer Ticket Number": "NA",
                        "Customer Ticket Created Date (MM/DD/YYYY)": "7/07/2025",
                        "Partner Ticket Number": "553418",
                        "Source of Request": "NA",
                        "PO number": "9200135149",
                        "Country": "Thailand",
                        "State": "Rayong",
                        "City": "Rayong",
                        "Site Address": "Common Site",
                        "Zip code": "NA",
                        "Activity Details": "Rayong || Thailand || HCL_CATERPILLAR || ETA: [07/07/2025], [08/07/2025], [09/07/2025] || P4 || Ban Khai UGM Need Backup tech",
                        "Dispatch Category": "NBD",
                        "Ticket Priority": "P4",
                        "ETA Date (MM/DD/YYYY)": "7/07/2025",
                        "ETA Time (HH:MM)": "NA",
                        "Technician Name": "NA",
                        "Technician IN Date (MM/DD/YYYY)": "7/07/2025",
                        "Technician IN Time": "7:30:00",
                        "Technician OUT Time": "17:00:00",
                        "Total Hours": "10",
                        "First Hour": "1714.56",
                        "First Hour rate": "1714.56",
                        "First Hour cost": "1714.56",
                        "Hours worked after First Hour": "1714.56",
                        "After First Hours rate": "NA",
                        "After First Hour cost": "NA",
                        "OT Hours": "NA",
                        "OT Hours rate": "NA",
                        "OT Hours Cost": "NA",
                        "Out of office Hours": "NA",
                        "Out of Office Hours Rate": "NA",
                        "Out of office Hours Cost": "NA",
                        "Weekened OT Hours": "NA",
                        "Weekend Rates": "NA",
                        "Weekend Cost": "NA",
                        "Travel/extra cost if applicable as per contract": "NA",
                        "Total Cost": "18002.88",
                        "Tax %": "NA",
                        "Tax cost": "NA",
                        "Total Cost including Tax": "NA",
                        "Currency": "THB",
                        "SLA Met": "Yes",
                        "Reason for SLA not met(if applicable)": "NA",
                        "CSR Report submitted": "Yes",
                        "Service Month (MM/YYYY)": "Nov-01",
                        "Remarks": ""
                    },
                    // Add more sample data rows as needed
                    {
                        "Site Category": "Dispatch",
                        "Customer Name": "Caterpillar",
                        "Partner Name": "Excis",
                        "Customer Ticket Number": "NA",
                        "Customer Ticket Created Date (MM/DD/YYYY)": "7/09/2025",
                        "Partner Ticket Number": "553418",
                        "Source of Request": "NA",
                        "PO number": "9200135149",
                        "Country": "Thailand",
                        "State": "Rayong",
                        "City": "Rayong",
                        "Site Address": "Common Site",
                        "Zip code": "NA",
                        "Activity Details": "Rayong || Thailand || HCL_CATERPILLAR || ETA: [07/07/2025], [08/07/2025], [09/07/2025] || P4 || Ban Khai UGM Need Backup tech",
                        "Dispatch Category": "NBD",
                        "Ticket Priority": "P4",
                        "ETA Date (MM/DD/YYYY)": "7/09/2025",
                        "ETA Time (HH:MM)": "NA",
                        "Technician Name": "NA",
                        "Technician IN Date (MM/DD/YYYY)": "7/09/2025",
                        "Technician IN Time": "8:00:00",
                        "Technician OUT Time": "16:30:00",
                        "Total Hours": "9",
                        "First Hour": "1714.56",
                        "First Hour rate": "1714.56",
                        "First Hour cost": "1714.56",
                        "Hours worked after First Hour": "1714.56",
                        "After First Hours rate": "NA",
                        "After First Hour cost": "NA",
                        "OT Hours": "NA",
                        "OT Hours rate": "NA",
                        "OT Hours Cost": "NA",
                        "Out of office Hours": "NA",
                        "Out of Office Hours Rate": "NA",
                        "Out of office Hours Cost": "NA",
                        "Weekened OT Hours": "NA",
                        "Weekend Rates": "NA",
                        "Weekend Cost": "NA",
                        "Travel/extra cost if applicable as per contract": "NA",
                        "Total Cost": "15431.04",
                        "Tax %": "NA",
                        "Tax cost": "NA",
                        "Total Cost including Tax": "NA",
                        "Currency": "THB",
                        "SLA Met": "Yes",
                        "Reason for SLA not met(if applicable)": "NA",
                        "CSR Report submitted": "Yes",
                        "Service Month (MM/YYYY)": "Nov-01",
                        "Remarks": ""
                    }
                ];
            }
            
            function processSampleData(data) {
                return data.map((item, index) => {
                    // Determine validation status based on data quality
                    let status = 'Valid';
                    let issues = 0;
                    
                    // Check for missing required fields
                    const requiredFields = ['Customer Name', 'Partner Name', 'Customer Ticket Created Date (MM/DD/YYYY)', 'Country', 'City'];
                    requiredFields.forEach(field => {
                        if (!item[field] || item[field] === 'NA' || item[field].trim() === '') {
                            issues++;
                            status = 'Warning';
                        }
                    });
                    
                    // Check for cost-related issues
                    if (item['Total Cost'] === 'NA' || parseFloat(item['Total Cost']) <= 0) {
                        issues++;
                        status = 'Error';
                    }
                    
                    return {
                        ...item,
                        id: `TICKET-${Date.now()}-${index}`,
                        status: status,
                        issues: issues,
                        region: getRegionFromCountry(item['Country'])
                    };
                });
            }
            
            function getRegionFromCountry(country) {
                const regionMap = {
                    'Thailand': 'APAC',
                    'Indonesia': 'APAC',
                    'USA': 'Americas',
                    'UK': 'Europe/Africa',
                    'Germany': 'Europe/Africa',
                    'UAE': 'Middle East'
                };
                return regionMap[country] || 'Other';
            }
            
            // Validation functionality
            validateFilesBtn.addEventListener('click', () => {
                if (uploadedFiles.some(f => f.status === 'uploaded')) {
                    runValidation();
                }
            });
            
            function runValidation() {
                showNotification('Starting validation process...', 'info');
                
                // Switch to validation tab
                document.querySelector('[data-tab="validation"]').click();
                
                // If no sample data loaded, use mock validation
                if (validationResults.length === 0) {
                    simulateValidation();
                } else {
                    // Use existing sample data
                    updateValidationSummary();
                    updateDataViews();
                    updateAnalytics();
                    
                    // Enable distribution button
                    startDistributionBtn.disabled = false;
                    
                    showNotification('Validation completed successfully!', 'success');
                }
            }
            
            function simulateValidation() {
                // Generate sample validation results
                validationResults = generateSampleValidationResults();
                
                // Update validation summary
                updateValidationSummary();
                
                // Update data views
                updateDataViews();
                
                // Update analytics
                updateAnalytics();
                
                // Enable distribution button
                startDistributionBtn.disabled = false;
                
                showNotification('Validation completed successfully!', 'success');
            }
            
            function generateSampleValidationResults() {
                const regions = ['Americas', 'Europe/Africa', 'APAC', 'Middle East'];
                const customers = ['HCL Corp', 'Tech Solutions', 'Global Systems', 'Enterprise IT'];
                const serviceTypes = ['Dispatch', 'Standby', 'Dedicated', 'Scheduled Visit'];
                
                const results = [];
                
                for (let i = 1; i <= 50; i++) {
                    const status = i <= 35 ? 'Valid' : (i <= 45 ? 'Warning' : 'Error');
                    const issueCount = status === 'Valid' ? 0 : (status === 'Warning' ? 1 : 2);
                    
                    results.push({
                        id: `TICKET-2024-${i.toString().padStart(3, '0')}`,
                        'Site Category': 'Dispatch',
                        'Customer Name': customers[i % customers.length],
                        'Partner Name': 'Partner ' + (i % 5 + 1),
                        'Customer Ticket Number': 'CT-' + (1000 + i),
                        'Customer Ticket Created Date (MM/DD/YYYY)': `01/${(i % 30 + 1).toString().padStart(2, '0')}/2024`,
                        'Country': ['USA', 'UK', 'Thailand', 'UAE'][i % 4],
                        'City': ['New York', 'London', 'Bangkok', 'Dubai'][i % 4],
                        'Total Cost': (500 + i * 100).toFixed(2),
                        'Currency': ['USD', 'GBP', 'THB', 'AED'][i % 4],
                        'SLA Met': i % 10 === 0 ? 'No' : 'Yes',
                        'CSR Report submitted': i % 20 === 0 ? 'No' : 'Yes',
                        region: regions[i % regions.length],
                        status: status,
                        issues: issueCount,
                        details: {
                            created: '2024-01-' + (15 + i % 15).toString().padStart(2, '0'),
                            priority: i % 3 === 0 ? 'P1' : (i % 3 === 1 ? 'P2' : 'P3'),
                            hours: (4 + i % 3) + ' hours'
                        }
                    });
                }
                
                return results;
            }
            
            function updateValidationSummary() {
                const validCount = validationResults.filter(r => r.status === 'Valid').length;
                const warningCount = validationResults.filter(r => r.status === 'Warning').length;
                const errorCount = validationResults.filter(r => r.status === 'Error').length;
                const totalCount = validationResults.length;
                
                document.getElementById('validCount').textContent = validCount;
                document.getElementById('warningCount').textContent = warningCount;
                document.getElementById('errorCount').textContent = errorCount;
                document.getElementById('totalCount').textContent = totalCount;
            }
            
            function updateDataViews() {
                updateTableView();
                if (currentView === 'form') {
                    updateFormView();
                }
            }
            
            function updateTableView() {
                const tableHeader = document.getElementById('tableHeader');
                const tableBody = document.getElementById('tableBody');
                
                // Clear existing content
                tableHeader.innerHTML = '';
                tableBody.innerHTML = '';
                
                if (validationResults.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="${columnDefinitions.length + 1}" style="text-align: center; padding: 40px;">
                                <div class="empty-state">
                                    <i class="fas fa-file-excel"></i>
                                    <p>Upload and validate files to see results</p>
                                </div>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                // Create table header
                const headerRow = document.createElement('tr');
                
                // Add ID column always visible
                const idHeader = document.createElement('th');
                idHeader.textContent = 'ID';
                idHeader.className = 'sortable';
                idHeader.setAttribute('data-column', 'id');
                idHeader.innerHTML = 'ID <span class="sort-icon"></span>';
                idHeader.addEventListener('click', () => sortTable('id'));
                headerRow.appendChild(idHeader);
                
                // Add other columns based on visibility
                columnDefinitions.forEach(column => {
                    if (columnVisibility[column.key] !== false) {
                        const th = document.createElement('th');
                        th.textContent = column.label;
                        th.className = 'sortable';
                        th.setAttribute('data-column', column.key);
                        th.innerHTML = `${column.label} <span class="sort-icon"></span>`;
                        th.addEventListener('click', () => sortTable(column.key));
                        headerRow.appendChild(th);
                    }
                });
                
                // Add status column always visible
                const statusHeader = document.createElement('th');
                statusHeader.textContent = 'Status';
                statusHeader.className = 'sortable';
                statusHeader.setAttribute('data-column', 'status');
                statusHeader.innerHTML = 'Status <span class="sort-icon"></span>';
                statusHeader.addEventListener('click', () => sortTable('status'));
                headerRow.appendChild(statusHeader);
                
                // Add actions column
                const actionsHeader = document.createElement('th');
                actionsHeader.textContent = 'Actions';
                headerRow.appendChild(actionsHeader);
                
                tableHeader.appendChild(headerRow);
                
                // Apply sorting
                let displayData = [...validationResults];
                if (sortColumn) {
                    displayData.sort((a, b) => {
                        let valA = a[sortColumn];
                        let valB = b[sortColumn];
                        
                        // Handle different data types
                        if (typeof valA === 'string') {
                            valA = valA.toLowerCase();
                            valB = valB.toLowerCase();
                        }
                        
                        if (valA < valB) return sortDirection === 'asc' ? -1 : 1;
                        if (valA > valB) return sortDirection === 'asc' ? 1 : -1;
                        return 0;
                    });
                }
                
                // Apply search filter
                const searchTerm = tableSearch.value.toLowerCase();
                if (searchTerm) {
                    displayData = displayData.filter(row => {
                        return Object.values(row).some(value => 
                            String(value).toLowerCase().includes(searchTerm)
                        );
                    });
                }
                
                // Calculate pagination
                const totalRows = displayData.length;
                totalPages = Math.ceil(totalRows / rowsPerPage);
                const startIndex = (currentPage - 1) * rowsPerPage;
                const endIndex = Math.min(startIndex + rowsPerPage, totalRows);
                const pageData = displayData.slice(startIndex, endIndex);
                
                // Create table rows
                pageData.forEach((row, rowIndex) => {
                    const tr = document.createElement('tr');
                    
                    // Add ID cell
                    const idCell = document.createElement('td');
                    idCell.innerHTML = `<strong>${row.id}</strong>`;
                    tr.appendChild(idCell);
                    
                    // Add other columns
                    columnDefinitions.forEach(column => {
                        if (columnVisibility[column.key] !== false) {
                            const td = document.createElement('td');
                            let value = row[column.key] || 'N/A';
                            
                            // Format based on column type
                            if (column.type === 'currency') {
                                value = formatCurrency(value, row['Currency']);
                            } else if (column.type === 'date') {
                                value = formatDate(value);
                            } else if (column.type === 'boolean') {
                                value = value === 'Yes' ? 
                                    '<span style="color: #48bb78;"> Yes</span>' : 
                                    '<span style="color: #f56565;"> No</span>';
                            }
                            
                            td.innerHTML = value;
                            tr.appendChild(td);
                        }
                    });
                    
                    // Add status cell
                    const statusCell = document.createElement('td');
                    let statusClass = '';
                    let statusText = row.status;
                    
                    if (row.status === 'Valid') {
                        statusClass = 'status-valid';
                        statusText = 'Valid';
                    } else if (row.status === 'Warning') {
                        statusClass = 'status-warning';
                        statusText = 'Warning';
                    } else {
                        statusClass = 'status-error';
                        statusText = 'Error';
                    }
                    
                    statusCell.innerHTML = `<span class="status-cell ${statusClass}">${statusText}</span>`;
                    tr.appendChild(statusCell);
                    
                    // Add actions cell
                    const actionsCell = document.createElement('td');
                    actionsCell.innerHTML = `
                        <button class="btn-icon-xs view-ticket-details" data-ticket-id="${row.id}" title="View Details">
                            <i class="fas fa-eye"></i>
                        </button>
                    `;
                    tr.appendChild(actionsCell);
                    
                    tableBody.appendChild(tr);
                });
                
                // Update pagination controls
                updatePagination(totalRows, startIndex, endIndex);
                
                // Add event listeners to view buttons
                document.querySelectorAll('.view-ticket-details').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const ticketId = e.currentTarget.getAttribute('data-ticket-id');
                        showTicketDetails(ticketId);
                    });
                });
                
                // Update sort indicators
                updateSortIndicators();
            }
            
            function updateSortIndicators() {
                // Remove existing sort classes
                document.querySelectorAll('.validation-table th').forEach(th => {
                    th.classList.remove('sort-asc', 'sort-desc');
                });
                
                // Add sort class to current sort column
                if (sortColumn) {
                    const header = document.querySelector(`.validation-table th[data-column="${sortColumn}"]`);
                    if (header) {
                        header.classList.add(sortDirection === 'asc' ? 'sort-asc' : 'sort-desc');
                    }
                }
            }
            
            function sortTable(column) {
                if (sortColumn === column) {
                    // Toggle direction if same column
                    sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
                } else {
                    // New column, default to ascending
                    sortColumn = column;
                    sortDirection = 'asc';
                }
                
                updateTableView();
            }
            
            function updatePagination(totalRows, startIndex, endIndex) {
                // Update pagination info
                document.getElementById('startRow').textContent = startIndex + 1;
                document.getElementById('endRow').textContent = endIndex;
                document.getElementById('totalRows').textContent = totalRows;
                
                // Update button states
                prevPageBtn.disabled = currentPage === 1;
                nextPageBtn.disabled = currentPage === totalPages;
                firstPageBtn.disabled = currentPage === 1;
                lastPageBtn.disabled = currentPage === totalPages;
                
                // Update page numbers
                pageNumbersDiv.innerHTML = '';
                
                // Always show first page
                addPageNumber(1);
                
                // Show ellipsis if needed
                if (currentPage > 3) {
                    const ellipsis = document.createElement('span');
                    ellipsis.textContent = '...';
                    ellipsis.style.padding = '0 8px';
                    pageNumbersDiv.appendChild(ellipsis);
                }
                
                // Show pages around current page
                const startPage = Math.max(2, currentPage - 1);
                const endPage = Math.min(totalPages - 1, currentPage + 1);
                
                for (let i = startPage; i <= endPage; i++) {
                    if (i > 1 && i < totalPages) {
                        addPageNumber(i);
                    }
                }
                
                // Show ellipsis if needed
                if (currentPage < totalPages - 2) {
                    const ellipsis = document.createElement('span');
                    ellipsis.textContent = '...';
                    ellipsis.style.padding = '0 8px';
                    pageNumbersDiv.appendChild(ellipsis);
                }
                
                // Always show last page if there is more than 1 page
                if (totalPages > 1) {
                    addPageNumber(totalPages);
                }
                
                function addPageNumber(page) {
                    const pageBtn = document.createElement('button');
                    pageBtn.className = 'page-number';
                    if (page === currentPage) {
                        pageBtn.classList.add('active');
                    }
                    pageBtn.textContent = page;
                    pageBtn.addEventListener('click', () => {
                        currentPage = page;
                        updateTableView();
                    });
                    pageNumbersDiv.appendChild(pageBtn);
                }
            }
            
            function updateFormView() {
                const ticketForm = document.getElementById('ticketForm');
                const currentTicketIndex = document.getElementById('currentTicketIndex');
                const totalTicketsForm = document.getElementById('totalTicketsForm');
                
                if (validationResults.length === 0) {
                    ticketForm.innerHTML = `
                        <div class="empty-state" style="text-align: center; padding: 40px;">
                            <i class="fas fa-file-excel"></i>
                            <p>Upload and validate files to see results</p>
                        </div>
                    `;
                    return;
                }
                
                // Update counters
                currentTicketIndex.textContent = currentFormIndex + 1;
                totalTicketsForm.textContent = validationResults.length;
                
                // Update navigation buttons
                prevTicketBtn.disabled = currentFormIndex === 0;
                nextTicketBtn.disabled = currentFormIndex === validationResults.length - 1;
                
                // Get current ticket
                const ticket = validationResults[currentFormIndex];
                
                // Build form HTML
                let formHTML = `
                    <div class="form-section">
                        <h4><i class="fas fa-info-circle"></i> Basic Information</h4>
                        <div class="form-grid">
                            <div class="form-field">
                                <label>Ticket ID</label>
                                <div class="field-value">${ticket.id}</div>
                            </div>
                            <div class="form-field">
                                <label>Status</label>
                                <div class="field-value">
                                    <span class="status-cell ${ticket.status === 'Valid' ? 'status-valid' : 
                                          ticket.status === 'Warning' ? 'status-warning' : 'status-error'}">
                                        ${ticket.status}
                                    </span>
                                </div>
                            </div>
                `;
                
                // Add basic info fields
                const basicFields = ['Customer Name', 'Partner Name', 'Country', 'City', 'Region'];
                basicFields.forEach(field => {
                    const value = ticket[field] || 'N/A';
                    formHTML += `
                        <div class="form-field">
                            <label>${field}</label>
                            <div class="field-value ${value === 'N/A' ? 'empty' : ''}">${value}</div>
                        </div>
                    `;
                });
                
                formHTML += `
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h4><i class="fas fa-calendar-alt"></i> Dates & Scheduling</h4>
                        <div class="form-grid">
                `;
                
                // Add date fields
                const dateFields = ['Customer Ticket Created Date (MM/DD/YYYY)', 'ETA Date (MM/DD/YYYY)', 'Technician IN Date (MM/DD/YYYY)'];
                dateFields.forEach(field => {
                    const value = ticket[field] || 'N/A';
                    formHTML += `
                        <div class="form-field">
                            <label>${field}</label>
                            <div class="field-value ${value === 'N/A' ? 'empty' : ''}">${formatDate(value)}</div>
                        </div>
                    `;
                });
                
                formHTML += `
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h4><i class="fas fa-dollar-sign"></i> Cost & Billing</h4>
                        <div class="form-grid">
                `;
                
                // Add cost fields
                const costFields = ['Total Cost', 'Currency', 'SLA Met', 'CSR Report submitted'];
                costFields.forEach(field => {
                    let value = ticket[field] || 'N/A';
                    
                    if (field === 'Total Cost') {
                        value = formatCurrency(value, ticket['Currency']);
                    } else if (field === 'SLA Met' || field === 'CSR Report submitted') {
                        value = value === 'Yes' ? 
                            '<span style="color: #48bb78;"> Yes</span>' : 
                            '<span style="color: #f56565;"> No</span>';
                    }
                    
                    formHTML += `
                        <div class="form-field">
                            <label>${field}</label>
                            <div class="field-value ${value === 'N/A' ? 'empty' : ''}">${value}</div>
                        </div>
                    `;
                });
                
                // Add remarks if available
                if (ticket['Remarks'] && ticket['Remarks'].trim() !== '') {
                    formHTML += `
                        <div class="form-section">
                            <h4><i class="fas fa-sticky-note"></i> Remarks</h4>
                            <div class="form-field">
                                <div class="field-value">${ticket['Remarks']}</div>
                            </div>
                        </div>
                    `;
                }
                
                // Add issues if any
                if (ticket.issues > 0) {
                    formHTML += `
                        <div class="form-section">
                            <h4><i class="fas fa-exclamation-triangle"></i> Validation Issues (${ticket.issues})</h4>
                            <div class="form-field">
                                <div class="field-value" style="background: #fff5f5; border-color: #fed7d7;">
                                    ${ticket.status === 'Warning' ? 
                                        'Missing supporting documentation' : 
                                        'Invalid PO number format, Missing mandatory fields'}
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                formHTML += `
                        </div>
                    </div>
                `;
                
                ticketForm.innerHTML = formHTML;
            }
            
            // Form navigation
            prevTicketBtn.addEventListener('click', () => {
                if (currentFormIndex > 0) {
                    currentFormIndex--;
                    updateFormView();
                }
            });
            
            nextTicketBtn.addEventListener('click', () => {
                if (currentFormIndex < validationResults.length - 1) {
                    currentFormIndex++;
                    updateFormView();
                }
            });
            
            // Pagination event listeners
            prevPageBtn.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    updateTableView();
                }
            });
            
            nextPageBtn.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    updateTableView();
                }
            });
            
            firstPageBtn.addEventListener('click', () => {
                currentPage = 1;
                updateTableView();
            });
            
            lastPageBtn.addEventListener('click', () => {
                currentPage = totalPages;
                updateTableView();
            });
            
            rowsPerPageSelect.addEventListener('change', () => {
                rowsPerPage = parseInt(rowsPerPageSelect.value);
                currentPage = 1;
                updateTableView();
            });
            
            // Search functionality
            tableSearch.addEventListener('input', () => {
                currentPage = 1;
                updateTableView();
            });
            
            // Column configuration
            function initializeColumnDefinitions() {
                columnDefinitions = [
                    { key: 'Site Category', label: 'Site Category', category: 'basic', visible: true },
                    { key: 'Customer Name', label: 'Customer', category: 'basic', visible: true },
                    { key: 'Partner Name', label: 'Partner', category: 'basic', visible: true },
                    { key: 'Customer Ticket Number', label: 'Customer Ticket #', category: 'basic', visible: true },
                    { key: 'Country', label: 'Country', category: 'basic', visible: true },
                    { key: 'City', label: 'City', category: 'basic', visible: true },
                    { key: 'Customer Ticket Created Date (MM/DD/YYYY)', label: 'Created Date', category: 'date', type: 'date', visible: true },
                    { key: 'ETA Date (MM/DD/YYYY)', label: 'ETA Date', category: 'date', type: 'date', visible: false },
                    { key: 'Technician IN Date (MM/DD/YYYY)', label: 'Tech IN Date', category: 'date', type: 'date', visible: false },
                    { key: 'Total Hours', label: 'Total Hours', category: 'service', visible: false },
                    { key: 'Total Cost', label: 'Total Cost', category: 'cost', type: 'currency', visible: true },
                    { key: 'Currency', label: 'Currency', category: 'cost', visible: true },
                    { key: 'SLA Met', label: 'SLA Met', category: 'service', type: 'boolean', visible: true },
                    { key: 'CSR Report submitted', label: 'CSR Submitted', category: 'service', type: 'boolean', visible: true },
                    { key: 'Dispatch Category', label: 'Dispatch Type', category: 'service', visible: false },
                    { key: 'Ticket Priority', label: 'Priority', category: 'service', visible: false },
                    { key: 'PO number', label: 'PO Number', category: 'basic', visible: false },
                    { key: 'Activity Details', label: 'Activity Details', category: 'service', visible: false }
                ];
                
                // Initialize visibility settings
                columnDefinitions.forEach(column => {
                    columnVisibility[column.key] = column.visible;
                });
                
                // Render column configuration modal
                renderColumnConfig();
            }
            
            function renderColumnConfig() {
                const categories = {
                    basic: document.getElementById('basicColumns'),
                    date: document.getElementById('dateColumns'),
                    cost: document.getElementById('costColumns'),
                    service: document.getElementById('serviceColumns')
                };
                
                // Clear existing content
                Object.values(categories).forEach(container => {
                    container.innerHTML = '';
                });
                
                // Add columns to their categories
                columnDefinitions.forEach(column => {
                    const container = categories[column.category];
                    if (container) {
                        const item = document.createElement('div');
                        item.className = 'column-item';
                        item.innerHTML = `
                            <input type="checkbox" id="col-${column.key}" ${columnVisibility[column.key] ? 'checked' : ''}>
                            <label for="col-${column.key}">${column.label}</label>
                        `;
                        container.appendChild(item);
                        
                        // Add event listener
                        const checkbox = item.querySelector('input');
                        checkbox.addEventListener('change', () => {
                            columnVisibility[column.key] = checkbox.checked;
                        });
                    }
                });
            }
            
            columnToggleBtn.addEventListener('click', () => {
                columnConfigModal.style.display = 'flex';
            });
            
            closeColumnModal.addEventListener('click', () => {
                columnConfigModal.style.display = 'none';
            });
            
            resetColumnsBtn.addEventListener('click', () => {
                // Reset to default visibility
                columnDefinitions.forEach(column => {
                    columnVisibility[column.key] = column.visible;
                });
                renderColumnConfig();
            });
            
            applyColumnsBtn.addEventListener('click', () => {
                columnConfigModal.style.display = 'none';
                updateTableView();
            });
            
            // Close modal when clicking outside
            columnConfigModal.addEventListener('click', (e) => {
                if (e.target === columnConfigModal) {
                    columnConfigModal.style.display = 'none';
                }
            });
            
            // Helper functions
            function formatCurrency(value, currency) {
                if (!value || value === 'NA' || isNaN(parseFloat(value))) return 'N/A';
                
                const numValue = parseFloat(value);
                const currencySymbols = {
                    'USD': '$',
                    'EUR': '',
                    'GBP': '',
                    'THB': '',
                    'IDR': 'Rp',
                    'AED': 'AED '
                };
                
                const symbol = currencySymbols[currency] || '';
                return `${symbol}${numValue.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            }
            
            function formatDate(dateString) {
                if (!dateString || dateString === 'NA') return 'N/A';
                
                try {
                    const date = new Date(dateString);
                    if (isNaN(date.getTime())) return dateString;
                    
                    return date.toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric'
                    });
                } catch (e) {
                    return dateString;
                }
            }
            
            // Rest of the existing functions (showTicketDetails, analytics, distribution, etc.)
            // ... (Keep all the existing functions from the original code)
            
            // Initialize empty state
            renderUploadedFiles();
            updateDataViews();
            
            // Load Chart.js if not already loaded
            if (typeof Chart === 'undefined') {
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/chart.js';
                script.onload = initializeCharts;
                document.head.appendChild(script);
            }
            
            function initializeCharts() {
                // Chart initialization code from original
                // ... (Keep the chart initialization code)
            }
            
            function showNotification(message, type) {
                // Notification code from original
                // ... (Keep the notification code)
            }
        });
    </script>
</section>
<!-- END STEP 1 -->



    <!-- STEP 2 -->
<!-- STEP 2 -->
<section class="card panel hide" data-step="2" id="step2">
  <h3>Step 2  Rate Card Assignment</h3>
  <div class="hint">
    SDM reviews the ticket data, validates accuracy, and incorporates FTE and Scheduled Visit (SV) data before submitting a prebilling file to the Excis FSO Team.
  </div>

  <!-- Ticket Table -->
  <table id="prebillingTable" style="width:100%; border-collapse:collapse; font-size:14px;">
    <thead>
      <tr style="background:#f0f0ff; text-align:left;">
        <th style="padding:8px;">Region</th>
        <th style="padding:8px;">Account Code</th>
        <th style="padding:8px;">Ticket Count</th>
        <th style="padding:8px;">Support Model</th>
        <th style="padding:8px;">FTE Data</th>
        <th style="padding:8px;">Scheduled Visits</th>
        <th style="padding:8px;">Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="padding:8px;">Americas</td>
        <td style="padding:8px;">HCL-AM-001</td>
        <td style="padding:8px;">12</td>
        <td style="padding:8px;">
          <select class="supportSelect" style="padding:4px;">
            <option>FTE</option>
            <option>Dispatch</option>
            <option>Scheduled Visit</option>
          </select>
        </td>
        <td style="padding:8px;" class="fteStatus"></td>
        <td style="padding:8px;" class="svStatus"></td>
        <td style="padding:8px;">
          <button class="btn small add-fte-btn">Add FTE</button>
          <button class="btn small add-sv-btn">Add SV</button>
        </td>
      </tr>
      <tr>
        <td style="padding:8px;">EMEA</td>
        <td style="padding:8px;">HCL-EU-002</td>
        <td style="padding:8px;">8</td>
        <td style="padding:8px;">
          <select class="supportSelect" style="padding:4px;">
            <option>FTE</option>
            <option>Dispatch</option>
            <option>Scheduled Visit</option>
          </select>
        </td>
        <td style="padding:8px;" class="fteStatus"></td>
        <td style="padding:8px;" class="svStatus"></td>
        <td style="padding:8px;">
          <button class="btn small add-fte-btn">Add FTE</button>
          <button class="btn small add-sv-btn">Add SV</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div style="margin-top:20px; display:flex; justify-content:flex-end; gap:10px;">
    <button id="submitPrebillingBtn" class="btn primary">
      <span class="material-symbols-outlined">send</span> Submit Prebilling
    </button>
  </div>

  <div id="submitMsg" style="display:none; margin-top:15px; padding:12px; border-radius:8px; background:#e8f5e9; color:#2e7d32; font-weight:500;">
     Prebilling file submitted to Excis FSO Team successfully!
  </div>
</section>

<!-- FTE Floating Modal -->
<div id="fteModal" class="modal hide">
  <div class="modal-content">
    <h4>Add FTE Data</h4>
    <label>Engineer Name</label>
    <input type="text" id="fteName" class="input" placeholder="Enter engineer name">

    <label>Working Days</label>
    <input type="number" id="fteDays" class="input" placeholder="e.g., 22">

    <label>Absent Days</label>
    <input type="number" id="fteAbsent" class="input" placeholder="e.g., 1">

    <label>Work Calendar</label>
    <table id="fteCalendar" style="width:100%; border-collapse:collapse; margin-top:6px;">
      <thead>
        <tr style="background:#f5f5f5; text-align:center;">
          <th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th>
        </tr>
      </thead>
      <tbody>
        <tr style="text-align:center;">
          <td><input type="checkbox" class="fteDay" value="Mon"></td>
          <td><input type="checkbox" class="fteDay" value="Tue"></td>
          <td><input type="checkbox" class="fteDay" value="Wed"></td>
          <td><input type="checkbox" class="fteDay" value="Thu"></td>
          <td><input type="checkbox" class="fteDay" value="Fri"></td>
        </tr>
      </tbody>
    </table>

    <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:15px;">
      <button id="closeFTE" class="btn">Cancel</button>
      <button id="saveFTE" class="btn primary">Save</button>
    </div>
  </div>
</div>

<!-- SV Floating Modal -->
<div id="svModal" class="modal hide">
  <div class="modal-content">
    <h4>Add Scheduled Visit</h4>
    <label>Day of the Week</label>
    <select id="svDay" class="input">
      <option>Monday</option><option>Tuesday</option><option>Wednesday</option>
      <option>Thursday</option><option>Friday</option>
    </select>
    <label>Visit Frequency</label>
    <input type="text" id="svFreq" class="input" placeholder="e.g., Weekly, Biweekly">
    <label>Remarks</label>
    <input type="text" id="svRemarks" class="input" placeholder="Optional remarks">
    <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:10px;">
      <button id="closeSV" class="btn">Cancel</button>
      <button id="saveSV" class="btn primary">Save</button>
    </div>
  </div>
</div>

<style>
.modal {
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.4);
  display: flex; align-items: center; justify-content: center;
  z-index: 200;
}
.modal-content {
  background: #fff; padding: 20px; border-radius: 12px;
  width: 360px; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}
.modal.hide {display:none;}
.modal-content h4 {margin-top:0;}
.input {
  width: 100%; padding: 6px 8px; margin-top:4px; margin-bottom:10px;
  border: 1px solid #ccc; border-radius: 6px;
}
.btn.small {font-size: 12px; padding: 4px 8px;}
.btn.primary {background: #1976d2; color: white; border: none;}
.btn.danger {background: #d32f2f; color: white; border: none;}
.btn:hover {opacity: 0.9;}
</style>

<script>
let currentFTERow = null;
let currentSVRow = null;

// Open FTE Modal
document.querySelectorAll('.add-fte-btn').forEach(btn => {
  btn.addEventListener('click', e => {
    currentFTERow = e.target.closest('tr');
    document.getElementById('fteModal').classList.remove('hide');
  });
});

// Open SV Modal
document.querySelectorAll('.add-sv-btn').forEach(btn => {
  btn.addEventListener('click', e => {
    currentSVRow = e.target.closest('tr');
    document.getElementById('svModal').classList.remove('hide');
  });
});

// Close Modals
document.getElementById('closeFTE').addEventListener('click', () => document.getElementById('fteModal').classList.add('hide'));
document.getElementById('closeSV').addEventListener('click', () => document.getElementById('svModal').classList.add('hide'));

// Save FTE
document.getElementById('saveFTE').addEventListener('click', () => {
  const name = document.getElementById('fteName').value;
  const days = document.getElementById('fteDays').value;
  const absent = document.getElementById('fteAbsent').value;
  const selectedDays = [...document.querySelectorAll('.fteDay:checked')].map(cb => cb.value).join(', ');
  currentFTERow.querySelector('.fteStatus').textContent = `${name}  ${days} days (${absent} absent) [${selectedDays}]`;
  currentFTERow.querySelector('.fteStatus').style.color = '#2e7d32';
  document.getElementById('fteModal').classList.add('hide');
});

// Save SV
document.getElementById('saveSV').addEventListener('click', () => {
  const day = document.getElementById('svDay').value;
  const freq = document.getElementById('svFreq').value;
  const remarks = document.getElementById('svRemarks').value;
  currentSVRow.querySelector('.svStatus').textContent = `${day} (${freq}) ${remarks}`;
  currentSVRow.querySelector('.svStatus').style.color = '#2e7d32';
  document.getElementById('svModal').classList.add('hide');
  document.getElementById('svDay').value = 'Monday';
  document.getElementById('svFreq').value = '';
  document.getElementById('svRemarks').value = '';
});

// Submit Prebilling
document.getElementById('submitPrebillingBtn').addEventListener('click', () => {
  const btn = document.getElementById('submitPrebillingBtn');
  btn.disabled = true;
  btn.innerHTML = '<span class="material-symbols-outlined">hourglass_empty</span> Submitting...';
  setTimeout(() => {
    btn.innerHTML = '<span class="material-symbols-outlined">check_circle</span> Submitted';
    document.getElementById('submitMsg').style.display = 'block';
    setStep(3);
  }, 1500);
});
</script>

<!-- STEP 5 -->
<section class="card panel" data-step="5" id="step5">
  <h3>Step 5  Review & Monitoring</h3>
  <p class="muted"><strong>Performed by:</strong> Admin & FSO</p>

  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
    <div class="section-title">HCL Review Tracker</div>
    <div>
      <button id="refreshStep5" class="btn primary" title="Refresh Data"> Refresh</button>
      <button id="viewCSV" class="btn" title="Download All as CSV"> All CSV</button>
      <button id="addBMSData" class="btn success" title="Add BMS Sample Data"> Add BMS Data</button>
    </div>
  </div>

  <table id="reviewTracker" style="width:100%; border-collapse:collapse; font-size:14px;">
    <thead>
      <tr style="background:#f0f0ff;">
        <th style="padding:8px;">Customer</th>
        <th style="padding:8px;">Country</th>
        <th style="padding:8px;">City</th>
        <th style="padding:8px;">Activity Details</th>
        <th style="padding:8px;">Date</th>
        <th style="padding:8px;">Total Hours</th>
        <th style="padding:8px;">Total Cost</th>
        <th style="padding:8px;">Status</th>
        <th style="padding:8px;">Actions</th>
      </tr>
    </thead>
    <tbody id="reviewBody">
    </tbody>
  </table>

<style>
/* Icon button styles */
.icon-btn {
  width: 32px;
  height: 32px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  margin: 2px;
  transition: all 0.2s;
}

.icon-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.icon-btn.approve {
  background: #4CAF50;
  color: white;
}

.icon-btn.reject {
  background: #f44336;
  color: white;
}

.icon-btn.view {
  background: #2196F3;
  color: white;
}

.icon-btn.edit {
  background: #FF9800;
  color: white;
}

.icon-btn.delete {
  background: #9C27B0;
  color: white;
}

.icon-btn.download {
  background: #009688;
  color: white;
}

.icon-btn-group {
  display: flex;
  flex-wrap: nowrap;
  gap: 3px;
}

/* Status badge styles */
.status-badge {
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: bold;
  display: inline-block;
}

.status-pending {
  background: #FF9800;
  color: white;
}

.status-approved {
  background: #4CAF50;
  color: white;
}

.status-rejected {
  background: #f44336;
  color: white;
}

/* Toast notifications */
@keyframes slideIn {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

@keyframes fadeOut {
  from { opacity: 1; }
  to { opacity: 0; }
}

.toast-notification {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 12px 20px;
  border-radius: 6px;
  color: white;
  font-weight: bold;
  z-index: 99999;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s;
  animation-fill-mode: forwards;
}

.toast-success { background: #4CAF50; }
.toast-error { background: #f44336; }
.toast-warning { background: #FF9800; }
.toast-info { background: #2196F3; }

/* Modal status badges */
.modal-status-badge {
  display: inline-block;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.modal-status-pending {
  background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
  color: white;
}

.modal-status-approved {
  background: linear-gradient(135deg, #4CAF50 0%, #388E3C 100%);
  color: white;
}

.modal-status-rejected {
  background: linear-gradient(135deg, #F44336 0%, #D32F2F 100%);
  color: white;
}

/* Button styles */
.btn {
  padding: 8px 16px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  font-size: 14px;
  transition: all 0.2s;
}

.btn.primary {
  background: #2196F3;
  color: white;
}

.btn.success {
  background: #4CAF50;
  color: white;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.btn.primary:hover {
  background: #1976D2;
}

.btn.success:hover {
  background: #388E3C;
}

.small {
  padding: 6px 12px;
  font-size: 12px;
}

/* Matching Matrix Styles */
.matrix-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding: 15px;
  background: #f8f9fa;
  border-radius: 8px;
  border: 1px solid #e0e0e0;
}

.mode-toggle {
  display: flex;
  align-items: center;
  gap: 15px;
}

.toggle-container {
  display: flex;
  align-items: center;
  gap: 10px;
}

.toggle-label {
  font-weight: 500;
  color: #333;
}

.toggle-switch-large {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 30px;
}

.toggle-switch-large input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider-large {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  transition: .4s;
  border-radius: 34px;
}

.toggle-slider-large:before {
  position: absolute;
  content: "";
  height: 22px;
  width: 22px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  transition: .4s;
  border-radius: 50%;
}

input:checked + .toggle-slider-large {
  background-color: #4CAF50;
}

input:checked + .toggle-slider-large:before {
  transform: translateX(30px);
}

.matrix-search {
  flex: 1;
  max-width: 300px;
  position: relative;
}

.matrix-search input {
  width: 100%;
  padding: 10px 15px 10px 40px;
  border: 2px solid #e0e0e0;
  border-radius: 6px;
  font-size: 0.95rem;
}

.matrix-search i {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #666;
}

.matrix-container {
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  overflow: auto;
  max-height: 500px;
  background: white;
  margin-bottom: 20px;
}

.matrix-table {
  width: 100%;
  border-collapse: collapse;
  min-width: 1000px;
}

.matrix-table th {
  background: #2c3e50;
  color: white;
  padding: 15px;
  text-align: left;
  font-weight: 600;
  position: sticky;
  top: 0;
  z-index: 10;
  min-width: 150px;
}

.matrix-table th:first-child {
  position: sticky;
  left: 0;
  background: #2c3e50;
  z-index: 20;
  min-width: 250px;
}

.matrix-table td {
  padding: 12px 15px;
  border-bottom: 1px solid #e0e0e0;
  border-right: 1px solid #e0e0e0;
  background: white;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.matrix-table td:first-child {
  position: sticky;
  left: 0;
  background: #f8f9fa;
  font-weight: 500;
  z-index: 5;
  min-width: 250px;
}

.matrix-table tr:hover td {
  background: #f8fafc;
}

.matrix-table tr:hover td:first-child {
  background: #e2e8f0;
}

.cell-check {
  color: #4CAF50;
  font-weight: bold;
  text-align: center;
}

.cell-cross {
  color: #f44336;
  font-weight: bold;
  text-align: center;
}

.cell-data {
  color: #333;
}

.highlight-column {
  background: #d1fae5 !important;
}

.highlight-duplicate {
  background: #fef3c7 !important;
  border: 1px solid #f59e0b !important;
}

.matrix-stats {
  display: flex;
  gap: 20px;
  margin-top: 20px;
  padding: 15px;
  background: #f8f9fa;
  border-radius: 8px;
  font-size: 0.9rem;
}

.stat-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 10px;
  background: white;
  border-radius: 6px;
  min-width: 100px;
}

.stat-value {
  font-weight: 700;
  font-size: 1.2rem;
  color: #2196F3;
}

.stat-label {
  font-size: 0.8rem;
  color: #666;
  text-align: center;
}

.matrix-legend {
  display: flex;
  gap: 20px;
  margin-top: 15px;
  padding: 10px;
  background: white;
  border-radius: 6px;
  border: 1px solid #e0e0e0;
  font-size: 0.85rem;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 5px;
}

.legend-color {
  width: 15px;
  height: 15px;
  border-radius: 3px;
}

.legend-check {
  background: #4CAF50;
}

.legend-cross {
  background: #f44336;
}

.legend-highlight {
  background: #d1fae5;
}

.legend-duplicate {
  background: #fef3c7;
}

/* Modal Tabs */
.modal-tabs {
  display: flex;
  background: #f8f9fa;
  border-bottom: 1px solid #e0e0e0;
  overflow-x: auto;
}

.modal-tab {
  padding: 15px 20px;
  background: none;
  border: none;
  border-bottom: 3px solid transparent;
  cursor: pointer;
  font-weight: 500;
  color: #666;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  gap: 8px;
  white-space: nowrap;
}

.modal-tab:hover {
  color: #333;
  background: rgba(255, 255, 255, 0.5);
}

.modal-tab.active {
  color: #2196F3;
  border-bottom-color: #2196F3;
  background: white;
}

.tab-content {
  display: none;
  overflow-y: auto;
  padding: 20px;
  flex: 1;
}

.tab-content.active {
  display: block;
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Data Selection */
.data-selection {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin-bottom: 20px;
}

.selection-group {
  background: #f8f9fa;
  padding: 15px;
  border-radius: 8px;
}

.selection-group label {
  display: block;
  font-weight: 600;
  margin-bottom: 8px;
  color: #333;
}

.selection-group select {
  width: 100%;
  padding: 10px;
  border: 2px solid #e0e0e0;
  border-radius: 6px;
  font-size: 0.95rem;
}
</style>

<script>
// BMS Sample Data (5 records)
const bmsSampleData = [
  {
    "Site Category": "Dispatch",
    "Customer Name": "BMS",
    "Partner Name": "Excis",
    "Customer Ticket Number": "INC6034671/INC6009208/REFTASK0087111/REFTASK0087112/HARL0018946/REFTASK0112747/REFTASK0112751/REFTASK0112752/REFTASK0112753/HWDISTASK0003872",
    "Customer Ticket Created Date (MM/DD/YYYY)": "11/26/2025",
    "Partner Ticket Number": "579435",
    "Source of Request": "Ticketing Tool",
    "PO number": "9200137647",
    "Country": "Chile",
    "State": "Santiago",
    "City": "Santiago",
    "Site Address": "5435 AV Presidente Riesco edificio Parque andino - 16th floor, Santiago",
    "Zip code": "7561127",
    "Activity Details": "Activities support for multiple ticket resolution and hardware disposal process management",
    "Dispatch Category": "NBD",
    "Ticket Priority": "P3",
    "ETA Date (MM/DD/YYYY)": "11/27/2025",
    "ETA Time (HH:MM)": "09:00",
    "Technician Name": "Jesus Diaz",
    "Technician IN Date (MM/DD/YYYY)": "11/27/2025",
    "Technician IN Time": "09:00",
    "Technician OUT Time": "15:00",
    "Total Hours": "6",
    "First Hour": "58",
    "First Hour rate": "58",
    "First Hour cost": "58",
    "Hours worked after First Hour": "5",
    "After First Hours rate": "58",
    "After First Hour cost": "290",
    "OT Hours": "0",
    "OT Hours rate": "0",
    "OT Hours Cost": "0",
    "Out of office Hours": "0",
    "Out of Office Hours Rate": "0",
    "Out of office Hours Cost": "0",
    "Weekened OT Hours": "0",
    "Weekend Rates": "0",
    "Weekend Cost": "0",
    "Travel/extra cost if applicable as per contract": "0",
    "Total Cost": "348",
    "Tax %": "0",
    "Tax cost": "0",
    "Total Cost including Tax": "348",
    "Currency": "USD",
    "SLA Met": "Yes",
    "Reason for SLA not met(if applicable)": "NA",
    "CSR Report submitted": "Yes",
    "Service Month (MM/YYYY)": "Nov-25",
    "Remarks": "Multiple ticket resolution completed successfully",
    "Status": "Pending",
    "Reviewer": "",
    "ReviewDate": ""
  },
  {
    "Site Category": "Dispatch",
    "Customer Name": "BMS",
    "Partner Name": "Excis",
    "Customer Ticket Number": "RITM7499510",
    "Customer Ticket Created Date (MM/DD/YYYY)": "11/14/2025",
    "Partner Ticket Number": "577634",
    "Source of Request": "Ticketing Tool",
    "PO number": "9200137647",
    "Country": "Peru",
    "State": "Lima",
    "City": "Lima",
    "Site Address": "Sta. Bernardita 080",
    "Zip code": "15001",
    "Activity Details": "Retrieve 2 laptops from departing users at Lima office location",
    "Dispatch Category": "NBD",
    "Ticket Priority": "P2",
    "ETA Date (MM/DD/YYYY)": "11/14/2025",
    "ETA Time (HH:MM)": "08:00",
    "Technician Name": "Francisco Velarde",
    "Technician IN Date (MM/DD/YYYY)": "11/14/2025",
    "Technician IN Time": "08:00",
    "Technician OUT Time": "11:30",
    "Total Hours": "3.5",
    "First Hour": "58",
    "First Hour rate": "58",
    "First Hour cost": "58",
    "Hours worked after First Hour": "2.5",
    "After First Hours rate": "58",
    "After First Hour cost": "145",
    "OT Hours": "0",
    "OT Hours rate": "0",
    "OT Hours Cost": "0",
    "Out of office Hours": "0",
    "Out of Office Hours Rate": "0",
    "Out of office Hours Cost": "0",
    "Weekened OT Hours": "0",
    "Weekend Rates": "0",
    "Weekend Cost": "0",
    "Travel/extra cost if applicable as per contract": "0",
    "Total Cost": "203",
    "Tax %": "0",
    "Tax cost": "0",
    "Total Cost including Tax": "203",
    "Currency": "USD",
    "SLA Met": "Yes",
    "Reason for SLA not met(if applicable)": "NA",
    "CSR Report submitted": "Yes",
    "Service Month (MM/YYYY)": "Nov-25",
    "Remarks": "Laptops retrieved successfully from both departing users",
    "Status": "Pending",
    "Reviewer": "",
    "ReviewDate": ""
  },
  {
    "Site Category": "Dispatch",
    "Customer Name": "BMS",
    "Partner Name": "Excis",
    "Customer Ticket Number": "REFTASK0087120, REFTASK0087121",
    "Customer Ticket Created Date (MM/DD/YYYY)": "11/07/2025",
    "Partner Ticket Number": "576516",
    "Source of Request": "Ticketing Tool",
    "PO number": "9200137647",
    "Country": "Peru",
    "State": "Lima",
    "City": "Lima",
    "Site Address": "Av.Jorge Basadre #607 San isidro Piso 3 , Lima Peru CP 15073",
    "Zip code": "15063",
    "Activity Details": "Retrieve 2 laptops from departing users at San Isidro office location",
    "Dispatch Category": "NBD",
    "Ticket Priority": "P2",
    "ETA Date (MM/DD/YYYY)": "11/12/2025",
    "ETA Time (HH:MM)": "08:00",
    "Technician Name": "Favio Nuez",
    "Technician IN Date (MM/DD/YYYY)": "11/14/2025",
    "Technician IN Time": "09:00",
    "Technician OUT Time": "12:30",
    "Total Hours": "3.5",
    "First Hour": "58",
    "First Hour rate": "58",
    "First Hour cost": "58",
    "Hours worked after First Hour": "2.5",
    "After First Hours rate": "58",
    "After First Hour cost": "145",
    "OT Hours": "0",
    "OT Hours rate": "0",
    "OT Hours Cost": "0",
    "Out of office Hours": "0",
    "Out of Office Hours Rate": "0",
    "Out of office Hours Cost": "0",
    "Weekened OT Hours": "0",
    "Weekend Rates": "0",
    "Weekend Cost": "0",
    "Travel/extra cost if applicable as per contract": "0",
    "Total Cost": "203",
    "Tax %": "0",
    "Tax cost": "0",
    "Total Cost including Tax": "203",
    "Currency": "USD",
    "SLA Met": "Yes",
    "Reason for SLA not met(if applicable)": "NA",
    "CSR Report submitted": "Yes",
    "Service Month (MM/YYYY)": "Nov-25",
    "Remarks": "Devices retrieved as scheduled",
    "Status": "Pending",
    "Reviewer": "",
    "ReviewDate": ""
  },
  {
    "Site Category": "Dispatch",
    "Customer Name": "BMS",
    "Partner Name": "Excis",
    "Customer Ticket Number": "REQTASK9385540, REFTASK0087111, REFTASK0087112, HARL0018946",
    "Customer Ticket Created Date (MM/DD/YYYY)": "11/07/2025",
    "Partner Ticket Number": "576513",
    "Source of Request": "Ticketing Tool",
    "PO number": "9200137647",
    "Country": "Chile",
    "State": "Santiago",
    "City": "Santiago",
    "Site Address": "5435 AV Presidente Riesco edificio Parque andino - 16th floor, Santiago",
    "Zip code": "7561127",
    "Activity Details": "Compression files refresh, opening returns and assignments, perform wipe for laptops for disposal process",
    "Dispatch Category": "NBD",
    "Ticket Priority": "P3",
    "ETA Date (MM/DD/YYYY)": "11/12/2025",
    "ETA Time (HH:MM)": "09:00",
    "Technician Name": "Jesus Diaz",
    "Technician IN Date (MM/DD/YYYY)": "11/12/2025",
    "Technician IN Time": "09:00",
    "Technician OUT Time": "16:00",
    "Total Hours": "7",
    "First Hour": "58",
    "First Hour rate": "58",
    "First Hour cost": "58",
    "Hours worked after First Hour": "6",
    "After First Hours rate": "58",
    "After First Hour cost": "348",
    "OT Hours": "0",
    "OT Hours rate": "0",
    "OT Hours Cost": "0",
    "Out of office Hours": "0",
    "Out of Office Hours Rate": "0",
    "Out of office Hours Cost": "0",
    "Weekened OT Hours": "0",
    "Weekend Rates": "0",
    "Weekend Cost": "0",
    "Travel/extra cost if applicable as per contract": "0",
    "Total Cost": "406",
    "Tax %": "0",
    "Tax cost": "0",
    "Total Cost including Tax": "406",
    "Currency": "USD",
    "SLA Met": "Yes",
    "Reason for SLA not met(if applicable)": "NA",
    "CSR Report submitted": "Yes",
    "Service Month (MM/YYYY)": "Nov-25",
    "Remarks": "All laptops wiped and ready for disposal",
    "Status": "Pending",
    "Reviewer": "",
    "ReviewDate": ""
  },
  {
    "Site Category": "Dispatch",
    "Customer Name": "BMS",
    "Partner Name": "Excis",
    "Customer Ticket Number": "HARRT0194740&HARRT0194741/REFTASK0087120, REFTASK0087121",
    "Customer Ticket Created Date (MM/DD/YYYY)": "11/03/2025",
    "Partner Ticket Number": "575817",
    "Source of Request": "Ticketing Tool",
    "PO number": "9200137647",
    "Country": "Peru",
    "State": "Lima",
    "City": "Lima",
    "Site Address": "Av.Jorge Basadre #607 San isidro Piso 3 , Lima Peru CP 15073",
    "Zip code": "15063",
    "Activity Details": "Departure user device retrieval - user returned devices on Nov 4th and perform retrieval",
    "Dispatch Category": "NBD",
    "Ticket Priority": "P2",
    "ETA Date (MM/DD/YYYY)": "11/05/2025",
    "ETA Time (HH:MM)": "11:15",
    "Technician Name": "Favio Nuez",
    "Technician IN Date (MM/DD/YYYY)": "11/14/2025",
    "Technician IN Time": "11:15",
    "Technician OUT Time": "16:00",
    "Total Hours": "4.75",
    "First Hour": "58",
    "First Hour rate": "58",
    "First Hour cost": "58",
    "Hours worked after First Hour": "3.75",
    "After First Hours rate": "58",
    "After First Hour cost": "217.5",
    "OT Hours": "0",
    "OT Hours rate": "0",
    "OT Hours Cost": "0",
    "Out of office Hours": "0",
    "Out of Office Hours Rate": "0",
    "Out of office Hours Cost": "0",
    "Weekened OT Hours": "0",
    "Weekend Rates": "0",
    "Weekend Cost": "0",
    "Travel/extra cost if applicable as per contract": "0",
    "Total Cost": "275.5",
    "Tax %": "0",
    "Tax cost": "0",
    "Total Cost including Tax": "275.5",
    "Currency": "USD",
    "SLA Met": "Yes",
    "Reason for SLA not met(if applicable)": "NA",
    "CSR Report submitted": "Yes",
    "Service Month (MM/YYYY)": "Nov-25",
    "Remarks": "Devices retrieved as per departure schedule",
    "Status": "Pending",
    "Reviewer": "",
    "ReviewDate": ""
  }
];

// Matching Matrix Data Structure
const matrixData = {
  columns: [
    // Columns common to all 6 cards
    { name: "Customer Name", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "PO Number", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "Currency", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "Remarks", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    
    // Columns in 5 cards
    { name: "Site Category", serviceRate: false, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "Partner Name", serviceRate: false, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "Country", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "State", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "City", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "Site Address", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "Zip Code", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "Tax %", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "Tax Cost", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "Total Cost", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    
    // Service Rate Card specific
    { name: "Region", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "Supplier", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "Entity", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "Payment", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "Status", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "SR Region", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "Rate Type", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "Rate Value", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "After Hours", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "Weekend", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "Travel", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "Includes Travel", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "FTE", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    { name: "Scheduled Visits", serviceRate: true, dispatch: false, standby: false, dedicated: false, sv: false, project: false },
    
    // Dispatch specific
    { name: "Customer Ticket Number", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: true, project: false },
    { name: "Customer Ticket Created Date", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: true, project: false },
    { name: "Partner Ticket Number", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: true, project: false },
    { name: "Source of Request", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: true, project: false },
    { name: "Dispatch Category", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: false, project: false },
    { name: "Ticket Priority", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: false, project: false },
    { name: "First Hour", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: false, project: false },
    { name: "First Hour Rate", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: false, project: false },
    { name: "First Hour Cost", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: false, project: false },
    { name: "Hours Worked After First Hour", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: false, project: false },
    { name: "After First Hour Rate", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: false, project: false },
    { name: "After First Hour Cost", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: false, project: false },
    
    // Stand-by specific
    { name: "Site Support", serviceRate: false, dispatch: false, standby: true, dedicated: false, sv: false, project: false },
    { name: "Stand-by Monthly Cost", serviceRate: false, dispatch: false, standby: true, dedicated: false, sv: false, project: false },
    
    // Dedicated specific
    { name: "Band", serviceRate: false, dispatch: false, standby: false, dedicated: true, sv: false, project: true },
    { name: "Variant", serviceRate: false, dispatch: false, standby: false, dedicated: true, sv: false, project: true },
    { name: "Number of Working Days", serviceRate: false, dispatch: false, standby: false, dedicated: true, sv: false, project: true },
    { name: "Number of Worked Days", serviceRate: false, dispatch: false, standby: false, dedicated: true, sv: false, project: true },
    { name: "Monthly Rate", serviceRate: false, dispatch: false, standby: false, dedicated: true, sv: false, project: true },
    { name: "Actual Cost", serviceRate: false, dispatch: false, standby: false, dedicated: true, sv: false, project: true },
    { name: "SLA %", serviceRate: false, dispatch: false, standby: false, dedicated: true, sv: false, project: false },
    { name: "Attendance Approved by Delivery", serviceRate: false, dispatch: false, standby: false, dedicated: true, sv: false, project: false },
    
    // SV Visit specific
    { name: "Category", serviceRate: false, dispatch: false, standby: false, dedicated: false, sv: true, project: false },
    { name: "Half Day Rate", serviceRate: false, dispatch: false, standby: false, dedicated: false, sv: true, project: false },
    { name: "Full Day Rate", serviceRate: false, dispatch: false, standby: false, dedicated: false, sv: true, project: false },
    { name: "Per Hour Rate", serviceRate: false, dispatch: false, standby: false, dedicated: false, sv: true, project: false },
    
    // Project Work specific
    { name: "Project Name", serviceRate: false, dispatch: false, standby: false, dedicated: false, sv: false, project: true },
    { name: "Project Start Date", serviceRate: false, dispatch: false, standby: false, dedicated: false, sv: false, project: true },
    { name: "Project End Date", serviceRate: false, dispatch: false, standby: false, dedicated: false, sv: false, project: true },
    
    // Shared columns
    { name: "Technician Name", serviceRate: false, dispatch: true, standby: false, dedicated: true, sv: true, project: true },
    { name: "ETA Date", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: true, project: false },
    { name: "ETA Time", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: true, project: false },
    { name: "Technician IN Date", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: true, project: false },
    { name: "Technician IN Time", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: true, project: false },
    { name: "Technician OUT Time", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: true, project: false },
    { name: "Total Hours", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: true, project: false },
    { name: "OT Hours", serviceRate: false, dispatch: true, standby: false, dedicated: true, sv: false, project: true },
    { name: "OT Rate", serviceRate: false, dispatch: true, standby: false, dedicated: true, sv: false, project: true },
    { name: "OT Cost", serviceRate: false, dispatch: true, standby: false, dedicated: true, sv: false, project: true },
    { name: "Weekend OT Hours", serviceRate: false, dispatch: true, standby: false, dedicated: true, sv: true, project: true },
    { name: "Weekend Rate", serviceRate: true, dispatch: true, standby: false, dedicated: true, sv: true, project: true },
    { name: "Weekend Cost", serviceRate: false, dispatch: true, standby: false, dedicated: true, sv: true, project: true },
    { name: "Travel/Extra Cost", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "Activity Details", serviceRate: false, dispatch: true, standby: false, dedicated: false, sv: true, project: false },
    { name: "SLA Met", serviceRate: false, dispatch: true, standby: false, dedicated: true, sv: true, project: true },
    { name: "Reason for SLA Not Met", serviceRate: false, dispatch: true, standby: false, dedicated: true, sv: true, project: true },
    { name: "Total Cost Including Tax", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true },
    { name: "Service Month", serviceRate: true, dispatch: true, standby: true, dedicated: true, sv: true, project: true }
  ],
  
  // Sample data for Data View mode
  sampleData: {
    hcl: {
      rev: {
        serviceRate: [
          { "Customer": "HCL", "Region": "APAC", "Country": "Singapore", "Supplier": "HCL", "Currency": "SGD", "Entity": "HCL SG", "Payment": "Monthly", "Status": "Active", "Category": "Dispatch", "SR Region": "APAC", "Rate Type": "Hourly", "Rate Value": "120", "After Hours": "150", "Weekend": "200", "Travel": "50", "Includes Travel": "Yes", "Remarks": "Standard", "FTE": "1", "Scheduled Visits": "12", "PO Number": "HCL-PO-001" }
        ],
        dispatch: [
          { "Customer Name": "HCL", "PO Number": "HCL-PO-001", "Site Category": "Data Center", "Technician Name": "John Doe", "Total Hours": "8", "Total Cost": "$960" }
        ],
        standby: [
          { "Customer Name": "HCL", "PO Number": "HCL-RET-001", "Stand-by Monthly Cost": "$5,000", "Total Cost": "$5,000" }
        ],
        dedicated: [
          { "Customer Name": "HCL", "PO Number": "HCL-DED-001", "Technician Name": "Mike Johnson", "Monthly Rate": "$8,000", "Actual Cost": "$8,000" }
        ],
        sv: [
          { "Customer Name": "HCL", "PO Number": "HCL-SV-001", "Technician Name": "Sarah Williams", "Half Day Rate": "$450", "Total Cost": "$450" }
        ],
        project: [
          { "Customer Name": "HCL", "PO Number": "HCL-PROJ-001", "Project Name": "Warehouse Automation", "Monthly Rate": "$12,000", "Actual Cost": "$12,000" }
        ]
      }
    },
    bms: {
      rev: {
        serviceRate: [
          { "Customer": "BMS", "Region": "LATAM", "Country": "Chile", "Supplier": "Excis", "Currency": "USD", "Entity": "BMS Chile", "Payment": "Monthly", "Status": "Active", "Category": "Dispatch", "SR Region": "LATAM", "Rate Type": "Hourly", "Rate Value": "58", "After Hours": "87", "Weekend": "116", "Travel": "29", "Includes Travel": "No", "Remarks": "BMS Standard Rate", "FTE": "0", "Scheduled Visits": "0", "PO Number": "9200137647" }
        ],
        dispatch: [
          { "Customer Name": "BMS", "PO Number": "9200137647", "Site Category": "Dispatch", "Technician Name": "Jesus Diaz", "Total Hours": "6", "Total Cost": "$348", "First Hour": "58", "First Hour Rate": "58", "First Hour Cost": "58", "Hours Worked After First Hour": "5", "After First Hour Rate": "58", "After First Hour Cost": "290", "Customer Ticket Number": "INC6034671/INC6009208/REFTASK0087111/REFTASK0087112/HARL0018946/REFTASK0112747/REFTASK0112751/REFTASK0112752/REFTASK0112753/HWDISTASK0003872", "Customer Ticket Created Date": "11/26/2025", "Partner Ticket Number": "579435", "Source of Request": "Ticketing Tool", "Country": "Chile", "State": "Santiago", "City": "Santiago", "Site Address": "5435 AV Presidente Riesco edificio Parque andino - 16th floor, Santiago", "Zip Code": "7561127", "Activity Details": "Activities support for multiple ticket resolution and hardware disposal process management", "Dispatch Category": "NBD", "Ticket Priority": "P3", "ETA Date": "11/27/2025", "ETA Time": "09:00", "Technician IN Date": "11/27/2025", "Technician IN Time": "09:00", "Technician OUT Time": "15:00", "SLA Met": "Yes", "Service Month": "Nov-25" }
        ],
        dedicated: [
          { "Customer Name": "BMS", "PO Number": "9200137647", "Technician Name": "Favio Nuez", "Monthly Rate": "$5,800", "Actual Cost": "$5,800", "Band": "L2", "Variant": "Standard", "Number of Working Days": "22", "Number of Worked Days": "18", "SLA %": "95%", "SLA Met": "Yes" }
        ]
      }
    }
  }
};

// Load data from localStorage or use empty array
function loadDispatchData() {
  const savedData = localStorage.getItem('dispatchRecords');
  if (savedData) {
    return JSON.parse(savedData);
  }
  return [];
}

// Save data to localStorage
function saveDispatchData(data) {
  localStorage.setItem('dispatchRecords', JSON.stringify(data));
}

// Add BMS sample data
function addBMSData() {
  if (confirm("Add 5 BMS sample records to the table? This will not replace existing data.")) {
    const currentData = loadDispatchData();
    
    // Check if BMS data already exists
    const existingBMSCount = currentData.filter(record => 
      record["Customer Name"] === "BMS"
    ).length;
    
    if (existingBMSCount >= 5) {
      showToast(" BMS data already exists in the table!", "warning");
      return;
    }
    
    // Add BMS sample data
    bmsSampleData.forEach(sample => {
      // Check if record already exists
      const exists = currentData.some(record => 
        record["Customer Ticket Number"] === sample["Customer Ticket Number"] && 
        record["Customer Ticket Created Date (MM/DD/YYYY)"] === sample["Customer Ticket Created Date (MM/DD/YYYY)"]
      );
      
      if (!exists) {
        currentData.push({...sample}); // Create a copy
      }
    });
    
    saveDispatchData(currentData);
    loadStep5Data();
    showToast(" 5 BMS records added successfully!", "success");
  }
}

function loadStep5Data() {
  const body = document.getElementById("reviewBody");
  body.innerHTML = "";

  const dispatchData = loadDispatchData();
  
  if (dispatchData.length === 0) {
    body.innerHTML = `
      <tr>
        <td colspan="9" style="text-align:center; padding:30px; color:#666;">
          <div style="margin-bottom:15px;">
            <i style="font-size:48px; color:#ccc;"></i>
          </div>
          <div style="font-size:16px; margin-bottom:20px;">No dispatch records found</div>
          <div style="display:flex; gap:10px; justify-content:center;">
            <button class="btn success" onclick="addBMSData()" style="display:flex; align-items:center; gap:8px;">
              <span></span> Add BMS Sample Data
            </button>
          </div>
        </td>
      </tr>`;
    return;
  }
  
  dispatchData.forEach((row, index) => {
    const statusClass = row.Status === "Approved" ? "status-approved" : 
                       row.Status === "Rejected" ? "status-rejected" : "status-pending";
    
    // Truncate activity details for display
    const activityDetails = row["Activity Details"] || "";
    const truncatedActivity = activityDetails.length > 60 
      ? activityDetails.substring(0, 60) + '...' 
      : activityDetails;
    
    // Format total cost with currency
    const totalCost = row["Total Cost"] || "0";
    const currency = row["Currency"] || "";
    const formattedCost = `${Number(totalCost).toLocaleString()} ${currency}`;
    
    body.innerHTML += `
      <tr>
        <td style="padding:12px 8px; border-bottom:1px solid #eee;">${row["Customer Name"]}</td>
        <td style="padding:12px 8px; border-bottom:1px solid #eee;">${row["Country"]}</td>
        <td style="padding:12px 8px; border-bottom:1px solid #eee;">${row["City"]}</td>
        <td style="padding:12px 8px; border-bottom:1px solid #eee;" title="${row["Activity Details"]}">
          <span style="cursor:help; border-bottom:1px dotted #666;">
            ${truncatedActivity}
          </span>
        </td>
        <td style="padding:12px 8px; border-bottom:1px solid #eee;">${row["Customer Ticket Created Date (MM/DD/YYYY)"]}</td>
        <td style="padding:12px 8px; border-bottom:1px solid #eee; text-align:center; font-weight:600;">${row["Total Hours"]}</td>
        <td style="padding:12px 8px; border-bottom:1px solid #eee; font-weight:600; color:#2196F3;">${formattedCost}</td>
        <td style="padding:12px 8px; border-bottom:1px solid #eee;">
          <span class="status-badge ${statusClass}">
            ${row.Status || "Pending"}
          </span>
        </td>
        <td style="padding:12px 8px; border-bottom:1px solid #eee;">
          <div class="icon-btn-group">
            <button class="icon-btn approve" title="Approve" onclick="approveRecord(${index})"></button>
            <button class="icon-btn reject" title="Reject" onclick="rejectRecord(${index})"></button>
            <button class="icon-btn view" title="View Details" onclick="viewRecordDetails(${index})"></button>
            <button class="icon-btn edit" title="Edit Record" onclick="editRecord(${index})"></button>
            <button class="icon-btn delete" title="Delete Record" onclick="deleteRecord(${index})"></button>
            <button class="icon-btn download" title="Download CSV" onclick="downloadRecordCSV(${index})"></button>
          </div>
        </td>
      </tr>`;
  });
}

function approveRecord(index) {
  const dispatchData = loadDispatchData();
  if (dispatchData[index]) {
    dispatchData[index].Status = "Approved";
    dispatchData[index].Reviewer = "Admin";
    dispatchData[index].ReviewDate = new Date().toLocaleDateString();
    saveDispatchData(dispatchData);
    showToast(" Record approved!", "success");
    loadStep5Data();
  }
}

function rejectRecord(index) {
  const dispatchData = loadDispatchData();
  if (dispatchData[index]) {
    dispatchData[index].Status = "Rejected";
    dispatchData[index].Reviewer = "Admin";
    dispatchData[index].ReviewDate = new Date().toLocaleDateString();
    saveDispatchData(dispatchData);
    showToast(" Record rejected!", "error");
    loadStep5Data();
  }
}

function editRecord(index) {
  const dispatchData = loadDispatchData();
  const record = dispatchData[index];
  
  if (record) {
    const newStatus = prompt("Change status for:\n" + 
                           `Customer: ${record["Customer Name"]}\n` +
                           `Ticket: ${record["Customer Ticket Number"]}\n` +
                           `Date: ${record["Customer Ticket Created Date (MM/DD/YYYY)"]}\n\n` +
                           "Enter new status (Pending, Approved, or Rejected):", record.Status || "Pending");
    
    if (newStatus !== null) {
      if (newStatus === "Approved" || newStatus === "Rejected" || newStatus === "Pending") {
        dispatchData[index].Status = newStatus;
        if (newStatus === "Approved" || newStatus === "Rejected") {
          dispatchData[index].Reviewer = "Admin";
          dispatchData[index].ReviewDate = new Date().toLocaleDateString();
        }
        saveDispatchData(dispatchData);
        showToast(" Record updated!", "info");
        loadStep5Data();
      } else {
        showToast(" Invalid status. Use: Pending, Approved, or Rejected", "warning");
      }
    }
  }
}

function deleteRecord(index) {
  const dispatchData = loadDispatchData();
  if (dispatchData[index]) {
    const record = dispatchData[index];
    if (confirm(`Delete this record?\n\nCustomer: ${record["Customer Name"]}\nTicket: ${record["Customer Ticket Number"]}\nDate: ${record["Customer Ticket Created Date (MM/DD/YYYY)"]}`)) {
      const deletedRecord = dispatchData.splice(index, 1);
      saveDispatchData(dispatchData);
      showToast(` Record deleted: ${deletedRecord[0]["Customer Name"]}`, "info");
      loadStep5Data();
    }
  }
}

function refreshData() {
  showToast(" Refreshing data...", "info");
  setTimeout(() => {
    loadStep5Data();
    showToast(" Data refreshed!", "success");
  }, 300);
}

function viewRecordDetails(index) {
  const data = loadDispatchData()[index];
  openModal(data);
}

function downloadRecordCSV(index) {
  const data = loadDispatchData()[index];
  const headers = Object.keys(data);
  const values = Object.values(data);
  
  const csvRows = [];
  csvRows.push(headers.join(","));
  csvRows.push(values.map(v => `"${v}"`).join(","));
  
  const csvContent = csvRows.join("\n");
  const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);
  
  const a = document.createElement("a");
  a.href = url;
  const fileName = `dispatch_${data["Customer Name"]}_${data["Customer Ticket Number"] || "NA"}_${data["Customer Ticket Created Date (MM/DD/YYYY)"].replace(/\//g, "-")}.csv`;
  a.download = fileName.replace(/[^a-zA-Z0-9_\-\.]/g, '_');
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  showToast(" CSV downloaded!", "success");
}

function viewCSVFile() {
  const dispatchData = loadDispatchData();
  if (dispatchData.length === 0) {
    showToast(" No data available", "warning");
    return;
  }
  
  const headers = Object.keys(dispatchData[0]);
  const csvRows = [headers.join(",")];
  
  dispatchData.forEach(row => {
    const values = headers.map(header => {
      const value = row[header];
      return `"${value}"`;
    });
    csvRows.push(values.join(","));
  });
  
  const csvContent = csvRows.join("\n");
  const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);
  
  const a = document.createElement("a");
  a.href = url;
  a.download = `all_dispatch_records_${new Date().toISOString().slice(0,10)}.csv`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  showToast(" All records downloaded as CSV!", "success");
}

// Toast notification function
function showToast(message, type = "info") {
  const existingToast = document.querySelector('.toast-notification');
  if (existingToast) {
    existingToast.remove();
  }
  
  const toast = document.createElement('div');
  toast.className = `toast-notification toast-${type}`;
  toast.innerHTML = message;
  document.body.appendChild(toast);
  
  setTimeout(() => {
    if (toast.parentNode) {
      toast.remove();
    }
  }, 3000);
}

// Create enhanced modal with tabs
const modal = document.createElement("div");
modal.id = "detailModal";
modal.style.cssText = "position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); display:none; justify-content:center; align-items:center; z-index:9999;";
modal.innerHTML = `
  <div style="background:white; padding:20px; width:95%; max-width:1400px; height:95%; overflow:hidden; border-radius:10px; position:relative; box-shadow:0 5px 30px rgba(0,0,0,0.3); display:flex; flex-direction:column;">
    <button onclick="closeModal()" style="position:absolute; top:20px; right:20px; background:#ff4444; color:white; border:none; border-radius:50%; width:40px; height:40px; cursor:pointer; font-size:20px; display:flex; align-items:center; justify-content:center; z-index:10;"></button>
    
    <div style="margin-bottom:20px; flex-shrink:0;">
      <h2 style="margin-top:0; color:#333; display:flex; align-items:center; gap:10px;">
         Dispatch Record Details
      </h2>
      <div style="display:flex; gap:15px; margin-bottom:15px; flex-wrap:wrap;">
        <div style="padding:10px 18px; background:#e3f2fd; border-radius:8px; font-weight:bold; display:flex; align-items:center; gap:8px; box-shadow:0 3px 6px rgba(0,0,0,0.08);">
          <i class="fas fa-user" style="color:#2196F3;"></i>
          <span id="customerNameDisplay">Customer Name</span>
        </div>
        <div style="padding:10px 18px; background:#e8f5e9; border-radius:8px; display:flex; align-items:center; gap:8px; box-shadow:0 3px 6px rgba(0,0,0,0.08);">
          <i class="fas fa-calendar-alt" style="color:#4CAF50;"></i>
          <span id="ticketDateDisplay">Date</span>
        </div>
        <div style="padding:10px 18px; background:#fff3e0; border-radius:8px; display:flex; align-items:center; gap:8px; box-shadow:0 3px 6px rgba(0,0,0,0.08);">
          <i class="fas fa-ticket-alt" style="color:#FF9800;"></i>
          <span id="ticketNumberDisplay">Ticket Number</span>
        </div>
        <div style="padding:10px 18px; background:#f3e5f5; border-radius:8px; display:flex; align-items:center; gap:8px; box-shadow:0 3px 6px rgba(0,0,0,0.08);">
          <i class="fas fa-flag" style="color:#9C27B0;"></i>
          <span id="statusDisplay">Status</span>
        </div>
      </div>
    </div>
    
    <!-- Modal Tabs -->
    <div class="modal-tabs">
      <button class="modal-tab active" onclick="switchModalTab('details')">
        <i class="fas fa-info-circle"></i> Record Details
      </button>
      <button class="modal-tab" onclick="switchModalTab('matrix')">
        <i class="fas fa-th"></i> Matching Matrix
      </button>
    </div>
    
    <!-- Tab Contents -->
    <div class="tab-content active" id="details-tab">
      <div id="modalContent" style="flex:1; overflow-y:auto; padding-right:10px; display:grid; grid-template-columns:repeat(auto-fill, minmax(400px, 1fr)); gap:20px; align-content:start;">
      </div>
    </div>
    
    <div class="tab-content" id="matrix-tab">
      <div style="height:100%; display:flex; flex-direction:column;">
        <!-- Matrix Controls -->
        <div class="matrix-controls">
          <div class="mode-toggle">
            <div class="toggle-container">
              <span class="toggle-label">Structural View</span>
              <label class="toggle-switch-large">
                <input type="checkbox" id="matrixModeToggle" onchange="toggleMatrixMode()">
                <span class="toggle-slider-large"></span>
              </label>
              <span class="toggle-label">Data View</span>
            </div>
            <div style="font-size:0.9rem; color:#666;">
              <span id="modeDescription"> /  column existence matrix</span>
            </div>
          </div>
          
          <div class="matrix-search">
            <i class="fas fa-search"></i>
            <input type="text" id="matrixSearch" placeholder="Search columns..." oninput="searchMatrixColumns()">
          </div>
        </div>
        
        <!-- Data Selection (only visible in Data View) -->
        <div id="dataSelection" style="display:none;">
          <div class="data-selection">
            <div class="selection-group">
              <label><i class="fas fa-building"></i> Customer</label>
              <select id="matrixCustomer" onchange="updateMatrixData()">
                <option value="">Select Customer</option>
                <option value="hcl">HCL</option>
                <option value="bms" selected>BMS</option>
              </select>
            </div>
            
            <div class="selection-group">
              <label><i class="fas fa-user-tag"></i> Account</label>
              <select id="matrixAccount" onchange="updateMatrixData()">
                <option value="">Select Account</option>
                <option value="rev" selected>REV</option>
                <option value="prod">Production</option>
              </select>
            </div>
          </div>
          
          <div style="margin-bottom:15px; font-size:0.9rem; color:#666;">
            <i class="fas fa-info-circle"></i> 
            Showing real data from selected customer and account
          </div>
        </div>
        
        <!-- Matrix Container -->
        <div class="matrix-container">
          <table class="matrix-table" id="matrixTable">
            <thead>
              <tr id="matrixHeader">
                <!-- Header will be populated by JavaScript -->
              </tr>
            </thead>
            <tbody id="matrixBody">
              <!-- Matrix rows will be populated by JavaScript -->
            </tbody>
          </table>
        </div>
        
        <!-- Matrix Legend -->
        <div class="matrix-legend">
          <div class="legend-item">
            <div class="legend-color legend-check"></div>
            <span>Column exists in card</span>
          </div>
          <div class="legend-item">
            <div class="legend-color legend-cross"></div>
            <span>Column not in card</span>
          </div>
          <div class="legend-item">
            <div class="legend-color legend-highlight"></div>
            <span>Search match / Selected column</span>
          </div>
          <div class="legend-item">
            <div class="legend-color legend-duplicate"></div>
            <span>Duplicate value detected</span>
          </div>
        </div>
        
        <!-- Matrix Statistics -->
        <div class="matrix-stats">
          <div class="stat-item">
            <div class="stat-value" id="totalColumns">0</div>
            <div class="stat-label">Total Columns</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="commonColumns">0</div>
            <div class="stat-label">Common to All</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="uniqueColumns">0</div>
            <div class="stat-label">Unique Columns</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="duplicateCount">0</div>
            <div class="stat-label">Duplicates</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="selectedCount">0</div>
            <div class="stat-label">Selected</div>
          </div>
        </div>
      </div>
    </div>
    
    <div style="text-align:center; padding-top:20px; border-top:2px solid #eee; margin-top:20px; flex-shrink:0;">
      <button class='btn primary' onclick='downloadCurrentRecordCSV()' style="padding:12px 30px; font-size:16px; display:inline-flex; align-items:center; gap:8px; background:#2196F3; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:600;">
        <i class="fas fa-download"></i> Download This Record as CSV
      </button>
      <button class='btn secondary' onclick='closeModal()' style="margin-left:15px; padding:12px 30px; font-size:16px; background:#757575; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:600;">Close</button>
    </div>
  </div>`;
document.body.appendChild(modal);

let currentModalData = null;

// Modal Tab Switching
function switchModalTab(tabName) {
  // Hide all tabs
  document.querySelectorAll('.tab-content').forEach(tab => {
    tab.classList.remove('active');
  });
  document.querySelectorAll('.modal-tab').forEach(tabBtn => {
    tabBtn.classList.remove('active');
  });
  
  // Show selected tab
  document.getElementById(`${tabName}-tab`).classList.add('active');
  document.querySelector(`[onclick="switchModalTab('${tabName}')"]`).classList.add('active');
  
  // Initialize matrix if switching to matrix tab
  if (tabName === 'matrix') {
    initializeMatrix();
  }
}

function openModal(data) {
  currentModalData = data;
  
  // Update header
  document.getElementById('customerNameDisplay').textContent = data["Customer Name"] || "N/A";
  document.getElementById('ticketDateDisplay').textContent = data["Customer Ticket Created Date (MM/DD/YYYY)"] || "N/A";
  document.getElementById('ticketNumberDisplay').textContent = data["Customer Ticket Number"] || "N/A";
  
  const statusValue = data["Status"] || "Pending";
  const statusClass = statusValue.toLowerCase() === "approved" ? "modal-status-approved" : 
                     statusValue.toLowerCase() === "rejected" ? "modal-status-rejected" : "modal-status-pending";
  document.getElementById('statusDisplay').innerHTML = `
    <span class="modal-status-badge ${statusClass}">
      ${statusValue}
    </span>
  `;
  
  // Load details tab content
  loadDetailsContent(data);
  
  // Reset to details tab
  switchModalTab('details');
  
  modal.style.display = "flex";
}

function loadDetailsContent(data) {
  const content = document.getElementById("modalContent");
  content.innerHTML = "";
  
  // Group fields by category
  const fieldGroups = {
    "Customer Information": ["Customer Name", "Partner Name", "Customer Ticket Number", "Customer Ticket Created Date (MM/DD/YYYY)"],
    "Ticket Details": ["Partner Ticket Number", "Source of Request", "PO number", "Dispatch Category", "Ticket Priority"],
    "Location": ["Country", "State", "City", "Site Address", "Zip code"],
    "Activity": ["Activity Details", "ETA Date (MM/DD/YYYY)", "ETA Time (HH:MM)"],
    "Technician": ["Technician Name", "Technician IN Date (MM/DD/YYYY)", "Technician IN Time", "Technician OUT Time", "Total Hours"],
    "Cost Details": ["First Hour", "First Hour rate", "First Hour cost", "Hours worked after First Hour", "After First Hours rate", "After First Hour cost", "Total Cost", "Currency"],
    "Additional Costs": ["OT Hours", "OT Hours rate", "OT Hours Cost", "Out of office Hours", "Out of Office Hours Rate", "Out of office Hours Cost", "Weekened OT Hours", "Weekend Rates", "Weekend Cost", "Travel/extra cost if applicable as per contract"],
    "Financial": ["Tax %", "Tax cost", "Total Cost including Tax"],
    "Service Info": ["SLA Met", "Reason for SLA not met(if applicable)", "CSR Report submitted", "Service Month (MM/YYYY)", "Remarks"],
    "Review": ["Status", "Reviewer", "ReviewDate"]
  };
  
  // Icon mapping
  const sectionIcons = {
    "Customer Information": "fas fa-users",
    "Ticket Details": "fas fa-ticket-alt",
    "Location": "fas fa-map-marker-alt",
    "Activity": "fas fa-tasks",
    "Technician": "fas fa-user-cog",
    "Cost Details": "fas fa-money-bill-wave",
    "Additional Costs": "fas fa-coins",
    "Financial": "fas fa-chart-line",
    "Service Info": "fas fa-clipboard-check",
    "Review": "fas fa-star"
  };
  
  // Color mapping
  const sectionColors = {
    "Customer Information": "#2196F3",
    "Ticket Details": "#FF9800",
    "Location": "#4CAF50",
    "Activity": "#9C27B0",
    "Technician": "#009688",
    "Cost Details": "#795548",
    "Additional Costs": "#607D8B",
    "Financial": "#F44336",
    "Service Info": "#3F51B5",
    "Review": "#FF5722"
  };
  
  Object.entries(fieldGroups).forEach(([groupName, fields]) => {
    const groupDiv = document.createElement("div");
    groupDiv.style.cssText = `
      background: #f8f9fa;
      border-radius: 10px;
      padding: 20px;
      border-left: 5px solid ${sectionColors[groupName] || "#4a6bdf"};
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transition: transform 0.2s ease;
    `;
    
    groupDiv.onmouseenter = () => {
      groupDiv.style.transform = "translateY(-3px)";
      groupDiv.style.boxShadow = "0 6px 16px rgba(0,0,0,0.12)";
    };
    groupDiv.onmouseleave = () => {
      groupDiv.style.transform = "translateY(0)";
      groupDiv.style.boxShadow = "0 4px 12px rgba(0,0,0,0.08)";
    };
    
    // Section header
    groupDiv.innerHTML = `
      <h4 style="margin-top:0; margin-bottom:15px; color:${sectionColors[groupName] || "#4a6bdf"}; display:flex; align-items:center; gap:10px; font-size:16px; border-bottom:2px solid rgba(0,0,0,0.1); padding-bottom:8px;">
        <i class="${sectionIcons[groupName] || "fas fa-folder"}"></i>
        ${groupName}
      </h4>
    `;
    
    const fieldsContainer = document.createElement("div");
    fieldsContainer.style.cssText = "display: flex; flex-direction: column; gap: 12px;";
    
    fields.forEach(key => {
      if (data.hasOwnProperty(key)) {
        const fieldValue = data[key];
        if (fieldValue === null || fieldValue === undefined || fieldValue === "" || fieldValue === "NA") return;
        
        const valueDiv = document.createElement("div");
        valueDiv.style.cssText = `
          background: white;
          padding: 12px 15px;
          border-radius: 8px;
          border: 1px solid #e0e0e0;
          transition: all 0.2s ease;
        `;
        
        valueDiv.onmouseenter = () => {
          valueDiv.style.borderColor = sectionColors[groupName] || "#4a6bdf";
          valueDiv.style.boxShadow = "0 3px 8px rgba(0,0,0,0.1)";
        };
        valueDiv.onmouseleave = () => {
          valueDiv.style.borderColor = "#e0e0e0";
          valueDiv.style.boxShadow = "none";
        };
        
        const labelDiv = document.createElement("div");
        labelDiv.style.cssText = `
          font-weight: 600;
          color: #555;
          font-size: 13px;
          margin-bottom: 6px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
          display: flex;
          align-items: center;
          gap: 6px;
        `;
        labelDiv.innerHTML = `<i class="fas fa-tag" style="color:#999; font-size:11px;"></i> ${key}`;
        
        const contentDiv = document.createElement("div");
        contentDiv.style.cssText = `
          color: #333;
          font-size: 14px;
          word-break: break-word;
          line-height: 1.5;
        `;
        
        if (fieldValue !== null && fieldValue !== undefined) {
          const strValue = String(fieldValue).trim();
          
          if (key === "Status") {
            const statusClass = strValue.toLowerCase() === "approved" ? "modal-status-approved" : 
                              strValue.toLowerCase() === "rejected" ? "modal-status-rejected" : "modal-status-pending";
            contentDiv.innerHTML = `
              <span class="modal-status-badge ${statusClass}">
                ${strValue}
              </span>
            `;
          } else if (key === "SLA Met") {
            contentDiv.innerHTML = strValue === "Yes" ? 
              '<span style="color:#4CAF50; font-weight:600;"><i class="fas fa-check-circle"></i> Yes</span>' : 
              '<span style="color:#F44336; font-weight:600;"><i class="fas fa-times-circle"></i> No</span>';
          } else if (key === "Currency") {
            contentDiv.innerHTML = `<span style="font-weight:600; color:#2196F3;">${strValue}</span>`;
          } else if (key.includes("Cost") || key.includes("Rate")) {
            const currency = data["Currency"] || "";
            contentDiv.innerHTML = `<span style="font-weight:600; color:#333;">${Number(strValue).toLocaleString()} ${currency}</span>`;
          } else if (key === "Activity Details" && strValue.length > 150) {
            const shortText = strValue.substring(0, 150) + '...';
            const fullText = strValue;
            contentDiv.innerHTML = `
              <div style="margin-bottom: 8px;">${shortText}</div>
              <button onclick="this.previousSibling.textContent = '${fullText.replace(/'/g, "\\'")}'; this.style.display='none'" 
                      style="background:#2196F3; color:white; border:none; padding:6px 12px; border-radius:4px; font-size:12px; cursor:pointer; display:flex; align-items:center; gap:4px;">
                <i class="fas fa-expand"></i> Show Full Details
              </button>
            `;
          } else if (key.includes("Date") || key.includes("Time")) {
            contentDiv.innerHTML = `<span style="color:#333;"><i class="far fa-clock" style="color:#FF9800; margin-right:6px;"></i> ${strValue}</span>`;
          } else {
            contentDiv.textContent = strValue;
          }
        } else {
          contentDiv.innerHTML = '<span style="color:#999; font-style:italic;">N/A</span>';
        }
        
        valueDiv.appendChild(labelDiv);
        valueDiv.appendChild(contentDiv);
        fieldsContainer.appendChild(valueDiv);
      }
    });
    
    if (fieldsContainer.children.length > 0) {
      groupDiv.appendChild(fieldsContainer);
      content.appendChild(groupDiv);
    }
  });
}

function closeModal() {
  modal.style.display = "none";
  currentModalData = null;
}

function downloadCurrentRecordCSV() {
  if (!currentModalData) return;
  
  const headers = Object.keys(currentModalData);
  const values = Object.values(currentModalData);
  
  const csvRows = [];
  csvRows.push(headers.join(","));
  csvRows.push(values.map(v => {
    const strValue = String(v || "");
    return `"${strValue.replace(/"/g, '""')}"`;
  }).join(","));
  
  const csvContent = csvRows.join("\n");
  const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);
  
  const a = document.createElement("a");
  a.href = url;
  const customerName = currentModalData["Customer Name"] || "Unknown";
  const ticketNumber = currentModalData["Customer Ticket Number"] || "NoTicket";
  const date = currentModalData["Customer Ticket Created Date (MM/DD/YYYY)"] || new Date().toISOString().slice(0,10);
  a.download = `Dispatch_${customerName.replace(/[^a-zA-Z0-9]/g, "_")}_${ticketNumber.replace(/[^a-zA-Z0-9]/g, "_")}_${date.replace(/\//g, "-")}.csv`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  showToast(" Record downloaded as CSV!", "success");
}

// Matching Matrix Functions
function initializeMatrix() {
  renderMatrixHeader();
  renderMatrixBody();
  updateMatrixStats();
}

function renderMatrixHeader() {
  const header = document.getElementById('matrixHeader');
  header.innerHTML = `
    <th style="min-width: 250px;">Column Name</th>
    <th>Service Rate</th>
    <th>Dispatch</th>
    <th>Stand-by</th>
    <th>Dedicated</th>
    <th>SV Visit</th>
    <th>Project Work</th>
  `;
}

function renderMatrixBody() {
  const body = document.getElementById('matrixBody');
  body.innerHTML = '';
  
  const isDataView = document.getElementById('matrixModeToggle').checked;
  const customer = document.getElementById('matrixCustomer')?.value;
  const account = document.getElementById('matrixAccount')?.value;
  
  matrixData.columns.forEach((column, index) => {
    const row = document.createElement('tr');
    row.setAttribute('data-column', column.name);
    row.setAttribute('data-index', index);
    
    // Column name cell
    const nameCell = document.createElement('td');
    nameCell.textContent = column.name;
    nameCell.style.cursor = 'pointer';
    nameCell.onclick = () => highlightColumn(column.name);
    row.appendChild(nameCell);
    
    // Card cells
    const cards = [
      { key: 'serviceRate', label: 'Service Rate' },
      { key: 'dispatch', label: 'Dispatch' },
      { key: 'standby', label: 'Stand-by' },
      { key: 'dedicated', label: 'Dedicated' },
      { key: 'sv', label: 'SV Visit' },
      { key: 'project', label: 'Project Work' }
    ];
    
    cards.forEach(card => {
      const cell = document.createElement('td');
      
      if (isDataView && customer && account) {
        // Data View Mode
        const data = getMatrixData(customer, account, card.key, column.name);
        if (column[card.key] && data) {
          cell.innerHTML = `<div class="cell-data" title="${data}">${data}</div>`;
          cell.classList.add('cell-data');
        } else if (column[card.key]) {
          cell.innerHTML = '<div class="cell-data"></div>';
          cell.classList.add('cell-data');
        } else {
          cell.innerHTML = '<div class="cell-data"></div>';
          cell.classList.add('cell-data');
        }
      } else {
        // Structural View Mode
        if (column[card.key]) {
          cell.innerHTML = '<div class="cell-check"></div>';
          cell.classList.add('cell-check');
        } else {
          cell.innerHTML = '<div class="cell-cross"></div>';
          cell.classList.add('cell-cross');
        }
      }
      
      // Add click handler for highlighting
      cell.onclick = () => {
        if (column[card.key]) {
          highlightColumn(column.name);
        }
      };
      
      row.appendChild(cell);
    });
    
    body.appendChild(row);
  });
  
  // Check for duplicates in Data View
  if (isDataView) {
    checkForDuplicates();
  }
}

function getMatrixData(customer, account, card, columnName) {
  try {
    const dataKey = card;
    const data = matrixData.sampleData[customer]?.[account]?.[dataKey];
    
    if (data && data.length > 0) {
      const firstRecord = data[0];
      
      // Try to find matching key in the record
      for (let key in firstRecord) {
        if (key.toLowerCase().replace(/[^a-z0-9]/g, '') === columnName.toLowerCase().replace(/[^a-z0-9]/g, '')) {
          return firstRecord[key] || '';
        }
      }
      
      // Try partial match
      for (let key in firstRecord) {
        if (key.toLowerCase().includes(columnName.toLowerCase().substring(0, 5))) {
          return firstRecord[key] || '';
        }
      }
    }
  } catch (e) {
    console.error('Error getting matrix data:', e);
  }
  return null;
}

function toggleMatrixMode() {
  const isDataView = document.getElementById('matrixModeToggle').checked;
  const dataSelection = document.getElementById('dataSelection');
  const modeDescription = document.getElementById('modeDescription');
  
  if (isDataView) {
    // Data View Mode
    dataSelection.style.display = 'block';
    modeDescription.textContent = 'Real data from selected customer/account';
    
    // Set default selections
    if (!document.getElementById('matrixCustomer').value) {
      document.getElementById('matrixCustomer').value = 'bms';
    }
    if (!document.getElementById('matrixAccount').value) {
      document.getElementById('matrixAccount').value = 'rev';
    }
    
    updateMatrixData();
  } else {
    // Structural View Mode
    dataSelection.style.display = 'none';
    modeDescription.textContent = ' /  column existence matrix';
    renderMatrixBody();
    updateMatrixStats();
  }
}

function updateMatrixData() {
  const customer = document.getElementById('matrixCustomer').value;
  const account = document.getElementById('matrixAccount').value;
  
  if (customer && account) {
    renderMatrixBody();
    updateMatrixStats();
  }
}

function searchMatrixColumns() {
  const searchTerm = document.getElementById('matrixSearch').value.toLowerCase();
  const rows = document.querySelectorAll('#matrixBody tr');
  
  // Remove previous highlights
  document.querySelectorAll('.highlight-column').forEach(el => {
    el.classList.remove('highlight-column');
  });
  
  if (!searchTerm) {
    document.getElementById('selectedCount').textContent = '0';
    return;
  }
  
  let matchCount = 0;
  rows.forEach(row => {
    const columnName = row.getAttribute('data-column').toLowerCase();
    if (columnName.includes(searchTerm)) {
      row.querySelectorAll('td').forEach(cell => {
        cell.classList.add('highlight-column');
      });
      matchCount++;
    }
  });
  
  document.getElementById('selectedCount').textContent = matchCount;
}

function highlightColumn(columnName) {
  // Remove previous highlights
  document.querySelectorAll('.highlight-column').forEach(el => {
    el.classList.remove('highlight-column');
  });
  
  // Highlight matching column
  const rows = document.querySelectorAll('#matrixBody tr');
  rows.forEach(row => {
    if (row.getAttribute('data-column') === columnName) {
      row.querySelectorAll('td').forEach(cell => {
        cell.classList.add('highlight-column');
      });
    }
  });
  
  // Update selected count
  document.getElementById('selectedCount').textContent = 1;
}

function checkForDuplicates() {
  const customer = document.getElementById('matrixCustomer').value;
  const account = document.getElementById('matrixAccount').value;
  
  if (!customer || !account) return;
  
  let duplicateCount = 0;
  
  // Check common fields for duplicates
  const commonFields = ['Customer Name', 'PO Number'];
  const seenValues = {};
  
  commonFields.forEach(field => {
    const values = [];
    
    // Collect values from all cards for this field
    ['serviceRate', 'dispatch', 'standby', 'dedicated', 'sv', 'project'].forEach(card => {
      const data = matrixData.sampleData[customer]?.[account]?.[card];
      if (data) {
        data.forEach(record => {
          if (record[field]) {
            values.push(record[field]);
          }
        });
      }
    });
    
    // Check for duplicates
    const uniqueValues = [...new Set(values)];
    if (values.length !== uniqueValues.length) {
      duplicateCount += (values.length - uniqueValues.length);
      
      // Highlight duplicate rows
      const rows = document.querySelectorAll('#matrixBody tr');
      rows.forEach(row => {
        if (row.getAttribute('data-column') === field) {
          row.querySelectorAll('td').forEach(cell => {
            cell.classList.add('highlight-duplicate');
          });
        }
      });
    }
  });
  
  document.getElementById('duplicateCount').textContent = duplicateCount;
}

function updateMatrixStats() {
  const totalColumns = matrixData.columns.length;
  const commonColumns = matrixData.columns.filter(col => 
    col.serviceRate && col.dispatch && col.standby && col.dedicated && col.sv && col.project
  ).length;
  const uniqueColumns = matrixData.columns.filter(col => {
    const presentCount = [col.serviceRate, col.dispatch, col.standby, col.dedicated, col.sv, col.project]
      .filter(Boolean).length;
    return presentCount === 1;
  }).length;
  
  document.getElementById('totalColumns').textContent = totalColumns;
  document.getElementById('commonColumns').textContent = commonColumns;
  document.getElementById('uniqueColumns').textContent = uniqueColumns;
  document.getElementById('duplicateCount').textContent = 0;
  document.getElementById('selectedCount').textContent = 0;
}

// Initialize event listeners
document.addEventListener('DOMContentLoaded', function() {
  const refreshBtn = document.getElementById("refreshStep5");
  const viewCSVBtn = document.getElementById("viewCSV");
  const addBMSBtn = document.getElementById("addBMSData");
  
  if (refreshBtn) refreshBtn.addEventListener("click", refreshData);
  if (viewCSVBtn) viewCSVBtn.addEventListener("click", viewCSVFile);
  if (addBMSBtn) addBMSBtn.addEventListener("click", addBMSData);
  
  // Load data on page load
  loadStep5Data();
});

// Listen for refresh messages from other pages
window.addEventListener('message', function(event) {
  if (event.data === 'refreshData') {
    refreshData();
    showToast(" Data refreshed from management page!", "success");
  }
});
</script>
</section>


    <!-- STEP 6-->
    <section class="card panel hide" data-step="5"><h3>Step 6: Generate File</h3><div class="placeholder">Final Export Placeholder</div></section>
  </div>

  <div class="footer">
    <button class="btn" id="backBtn">Back</button>
    <button class="btn primary" id="continueBtn">Continue</button>
  </div>
</div>

<script>
let currentStep=1;
function setStep(n){
  currentStep=n;
  document.querySelectorAll('.step').forEach(el=>el.classList.toggle('active',+el.dataset.step===n));
  document.querySelectorAll('#steps > section').forEach(el=>el.classList.toggle('hide',+el.dataset.step!==n));
}
document.getElementById('continueBtn').addEventListener('click',()=>setStep(Math.min(5,currentStep+1)));
document.getElementById('backBtn').addEventListener('click',()=>setStep(Math.max(1,currentStep-1)));
document.querySelectorAll('.step').forEach(el=>el.addEventListener('click',()=>setStep(+el.dataset.step)));

// ACTION BUTTONS
document.querySelectorAll('.viewBtn').forEach(btn => {
  btn.addEventListener('click', () => {
    alert('Viewing ticket details for ' + btn.closest('tr').children[0].textContent);
  });
});

document.querySelectorAll('.editBtn').forEach(btn => {
  btn.addEventListener('click', () => {
    alert('Editing ticket for ' + btn.closest('tr').children[0].textContent);
  });
});

// DISTRIBUTE TICKETS FUNCTION
document.getElementById('distributeBtn').addEventListener('click', function() {
  const btn = this;
  const rows = document.querySelectorAll('#ticketTable .status');
  let completed = 0;

  btn.disabled = true;
  btn.innerHTML = '<span class="material-symbols-outlined">hourglass_empty</span> Distributing...';

  rows.forEach((cell, index) => {
    setTimeout(() => {
      cell.textContent = 'Sent';
      cell.style.color = '#2e7d32';
      cell.style.fontWeight = '600';
      completed++;
      document.getElementById('completedCount').textContent = completed;
      document.getElementById('pendingCount').textContent = rows.length - completed;

      // when done, update button and proceed to step 2
      if (completed === rows.length) {
        btn.innerHTML = '<span class="material-symbols-outlined">check_circle</span> Distribution Completed';
        btn.style.background = '#2e7d32';
        btn.style.color = '#fff';
        setTimeout(() => {
          setStep(2); // move automatically to Step 2
        }, 1200);
      }
    }, 1000 * (index + 1));
  });
});
</script>

            </div>
        </div>
        <!--**********************************
    Content body end
***********************************-->
        <!--**********************************
    Footer start
***********************************-->
        






        <!--**********************************
    Footer end
***********************************-->

    </div>
    <script src="./public/assets/vendor/global/global.min.js"></script>
    <script src="./public/assets/vendor/bootstrap-select/dist/js/bootstrap-select.min.js"></script>



    <script src="./public/assets/js/dlabnav-init.js"></script>
    <script src="./public/assets/js/custom.min.js"></script>
    <script src="./public/assets/js/demo.js"></script>
    <script src="./public/assets/js/styleSwitcher.js"></script>


    <!--**********************************
        Main wrapper end
    ***********************************-->
</body>

</html>